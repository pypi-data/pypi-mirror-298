import"./sha256.CRlV3BEV.js";import{g as F}from"./index.DG_x0ggz.js";let m;const T=new Uint8Array(16);function U(){if(!m&&(m=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!m))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return m(T)}const c=[];for(let e=0;e<256;++e)c.push((e+256).toString(16).slice(1));function E(e,t=0){return c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]}const A=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),x={randomUUID:A};function R(e,t,n){if(x.randomUUID&&!t&&!e)return x.randomUUID();e=e||{};const s=e.random||(e.rng||U)();return s[6]=s[6]&15|64,s[8]=s[8]&63|128,E(s)}var h=(e=>(e.PUNCTUATION="punctuation",e.PARAGRAPHS="paragraphs",e.NONE="none",e))(h||{});const V=(e,t,n)=>{const s=/{{char}}/gi,r=/{{user}}/gi,o=/{{VIDEO_FILE_ID_([a-f0-9-]+)}}/gi,a=/{{HTML_FILE_ID_([a-f0-9-]+)}}/gi;return t!=null&&(e=e.replace(s,t)),n!=null&&(e=e.replace(r,n)),e=e.replace(o,(l,i)=>`<video src="${`${F}/api/v1/files/${i}/content`}" controls></video>`),e=e.replace(a,(l,i)=>`<iframe src="${`${F}/api/v1/files/${i}/content`}" width="100%" frameborder="0" onload="this.style.height=(this.contentWindow.document.body.scrollHeight+20)+'px';"></iframe>`),e},Y=e=>e.replace(/<\|[a-z]*$/,"").replace(/<\|[a-z]+\|$/,"").replace(/<$/,"").replaceAll(/<\|[a-z]+\|>/g," ").replaceAll("<","&lt;").replaceAll(">","&gt;").trim(),j=e=>e.trim(),G=e=>e.replaceAll("&lt;","<").replaceAll("&gt;",">");function q(e){return new DOMParser().parseFromString(e,"text/html").documentElement.textContent}const Z=e=>{let t="";return new TransformStream({transform(n,s){t+=n;const r=t.split(e);r.slice(0,-1).forEach(o=>s.enqueue(o)),t=r[r.length-1]},flush(n){t&&n.enqueue(t)}})},K=e=>{const t={messages:{},currentId:null};let n=null,s=null;for(const r of e)s=R(),n!==null&&(t.messages[n].childrenIds=[...t.messages[n].childrenIds,s]),t.messages[s]={...r,id:s,parentId:n,childrenIds:[]},n=s;return t.currentId=s,t},b=()=>{const e=document.createElement("canvas"),t=e.getContext("2d");e.height=1,e.width=1;const n=new ImageData(e.width,e.height),s=n.data;for(let o=0;o<n.data.length;o+=1)o%4!==3?s[o]=Math.floor(256*Math.random()):s[o]=255;t.putImageData(n,0,0);const r=t.getImageData(0,0,e.width,e.height).data;for(let o=0;o<r.length;o+=1)if(r[o]!==s[o])return console.log("canvasPixelTest: Wrong canvas pixel RGB value detected:",r[o],"at:",o,"expected:",s[o]),console.log("canvasPixelTest: Canvas blocking or spoofing is likely"),!1;return!0},J=e=>{const t=document.createElement("canvas"),n=t.getContext("2d");if(t.width=100,t.height=100,!b())return console.log("generateInitialsImage: failed pixel test, fingerprint evasion is likely. Using default image."),"/user.png";n.fillStyle="#F39C12",n.fillRect(0,0,t.width,t.height),n.fillStyle="#FFFFFF",n.font="40px Helvetica",n.textAlign="center",n.textBaseline="middle";const s=e.trim(),r=s.length>0?s[0]+(s.split(" ").length>1?s[s.lastIndexOf(" ")+1]:""):"";return n.fillText(r.toUpperCase(),t.width/2,t.height/2),t.toDataURL()},Q=async e=>{let t=!1;if(!navigator.clipboard){const n=document.createElement("textarea");n.value=e,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();try{const r=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+r),t=!0}catch(s){console.error("Fallback: Oops, unable to copy",s)}return document.body.removeChild(n),t}return t=await navigator.clipboard.writeText(e).then(()=>(console.log("Async: Copying to clipboard was successful!"),!0)).catch(n=>(console.error("Async: Could not copy text: ",n),!1)),t},X=(e,t)=>t==="0.0.0"?!1:t.localeCompare(e,void 0,{numeric:!0,sensitivity:"case",caseFirst:"upper"})<0,ee=e=>{const t=/\[([^\]]+)\]/g,n=[];let s;for(;(s=t.exec(e))!==null;)n.push({word:s[1],startIndex:s.index,endIndex:t.lastIndex-1});return n},te=(e,t)=>{const n=e.split(" ");n.at(-1)===t&&n.pop();let s=n.join(" ");return s!==""&&(s+=" "),s},ne=e=>e.toLowerCase().replace(/[^\w\s]/g,"").replace(/\s+/g,"-"),se=e=>"mapping"in e[0]?"openai":"webui",re=async(e=!1)=>{const t=await new Promise((r,o)=>{navigator.geolocation.getCurrentPosition(r,o)}).catch(r=>{throw console.error("Error getting user location:",r),r});if(!t)return"Location not available";const{latitude:n,longitude:s}=t.coords;return e?{latitude:n,longitude:s}:`${n.toFixed(3)}, ${s.toFixed(3)} (lat, long)`},S=e=>{var l,i,u,d,I,w,v,D;const t=e.mapping,n=[];let s="",r=null;for(const p in t){const g=t[p];s=p;try{if(n.length==0&&(g.message==null||((l=g.message.content.parts)==null?void 0:l[0])==""&&g.message.content.text==null))continue;{const f={id:p,parentId:r,childrenIds:g.children||[],role:((u=(i=g.message)==null?void 0:i.author)==null?void 0:u.role)!=="user"?"assistant":"user",content:((w=(I=(d=g.message)==null?void 0:d.content)==null?void 0:I.parts)==null?void 0:w[0])||((D=(v=g.message)==null?void 0:v.content)==null?void 0:D.text)||"",model:"gpt-3.5-turbo",done:!0,context:null};n.push(f),r=s}}catch(f){console.log("Error with",g,`
Error:`,f)}}const o={};return n.forEach(p=>o[p.id]=p),{history:{currentId:s,messages:o},models:["gpt-3.5-turbo"],messages:n,options:{},timestamp:e.create_time,title:e.title??"New Chat"}},M=e=>{const t=e.messages;if(t.length===0||t[t.length-1].childrenIds.length!==0||t[0].parentId!==null)return!1;for(const r of t)if(typeof r.content!="string")return!1;return!0},oe=e=>{const t=[];let n=0;for(const s of e){const r=S(s);M(r)?t.push({id:s.id,user_id:"",title:s.title,chat:r,timestamp:s.timestamp}):n++}return console.log(n,"Conversations could not be imported"),t},ae=e=>{let t;try{t=new URL(e)}catch{return!1}return t.protocol==="http:"||t.protocol==="https:"},N=e=>{const t=/[\uD800-\uDBFF][\uDC00-\uDFFF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g;return e.replace(t,"")},k=e=>e.replace(/(\*)(.*?)\1/g,"").replace(/(```)(.*?)\1/gs,""),y=e=>k(N(e.trim())),C=/```[\s\S]*?```/g,$=e=>{const t=[];let n=0;e=e.replace(C,r=>{const o=`\0${n}\0`;return t[n++]=r,o});let s=e.split(new RegExp("(?<=[.!?])\\s+"));return s=s.map(r=>r.replace(/\u0000(\d+)\u0000/g,(o,a)=>t[a])),s.map(y).filter(Boolean)},_=e=>{const t=[];let n=0;e=e.replace(C,r=>{const o=`\0${n}\0`;return t[n++]=r,o});let s=e.split(/\n+/);return s=s.map(r=>r.replace(/\u0000(\d+)\u0000/g,(o,a)=>t[a])),s.map(y).filter(Boolean)},P=e=>$(e).reduce((t,n)=>{const s=t.length-1;if(s>=0){const r=t[s],o=r.split(/\s+/).length,a=r.length;o<4||a<50?t[s]=r+" "+n:t.push(n)}else t.push(n);return t},[]),ce=(e,t="punctuation")=>{const n=[];switch(t){default:case h.PUNCTUATION:n.push(...P(e));break;case h.PARAGRAPHS:n.push(..._(e));break;case h.NONE:n.push(y(e));break}return n},ie=(e,t)=>new File([e],t,{type:e.type}),le=(e,t,n)=>{const s=new Date,r=s.getFullYear()+"-"+String(s.getMonth()+1).padStart(2,"0")+"-"+String(s.getDate()).padStart(2,"0"),o=s.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}),a=B(),l=z(),i=localStorage.getItem("locale")||"en-US";return e=e.replace("{{CURRENT_DATETIME}}",`${r} ${o}`),e=e.replace("{{CURRENT_DATE}}",r),e=e.replace("{{CURRENT_TIME}}",o),e=e.replace("{{CURRENT_WEEKDAY}}",a),e=e.replace("{{CURRENT_TIMEZONE}}",l),e=e.replace("{{USER_LANGUAGE}}",i),t&&(e=e.replace("{{USER_NAME}}",t)),n&&(e=e.replace("{{USER_LOCATION}}",n)),e},ue=e=>{const t=Math.floor(e/1e9%60),n=Math.floor(e/6e10%60),s=Math.floor(e/36e11%24),r=[];return t>=0&&r.push(`${t}s`),n>0&&r.push(`${n}m`),s>0&&r.push(`${s}h`),r.reverse().join(" ")},de=e=>{const t=new Date,n=new Date(e*1e3),r=(t.getTime()-n.getTime())/(1e3*3600*24),o=t.getDate(),a=t.getMonth(),l=t.getFullYear(),i=n.getDate(),u=n.getMonth(),d=n.getFullYear();return l===d&&a===u&&o===i?"Today":l===d&&a===u&&o-i===1?"Yesterday":r<=7?"Previous 7 days":r<=30?"Previous 30 days":l===d?n.toLocaleString("default",{month:"long"}):n.getFullYear().toString()},ge=e=>{const t={};let n=!1,s=!1;const r=/^\s*([a-z_]+):\s*(.*)\s*$/i,o=e.split(`
`);if(o[0].trim()!=='"""')return{};n=!0;for(let a=1;a<o.length;a++){const l=o[a];if(l.includes('"""')&&n){s=!0;break}if(n&&!s){const i=r.exec(l);if(i){const[,u,d]=i;t[u.trim()]=d.trim()}}}return t},pe=(e,t,n)=>{const s=e.map(o=>o.code);return t.map(o=>s.find(a=>a.startsWith(o))).find(Boolean)||n},O=()=>new Date().toISOString().split("T")[0],L=()=>new Date().toTimeString().split(" ")[0],me=()=>`${O()} ${L()}`,z=()=>Intl.DateTimeFormat().resolvedOptions().timeZone,B=()=>["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date().getDay()];export{ce as A,q as B,G as C,V as D,j as E,ue as F,h as T,K as a,de as b,X as c,re as d,ge as e,Y as f,J as g,ie as h,Q as i,b as j,se as k,oe as l,pe as m,O as n,L as o,me as p,z as q,B as r,Z as s,ne as t,E as u,R as v,ee as w,te as x,ae as y,le as z};
//# sourceMappingURL=index.Dqt4dRBk.js.map
