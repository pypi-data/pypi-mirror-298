System.register(["vue","./sentry-legacy.5.2.3.dev30935.js","vue-content-loader","./_commonjsHelpers-legacy.5.2.3.dev30935.js"],(function(e,a){"use strict";var l,t,r,s,o,n,i,d,u,c,f,m,b,p,v,g,_,y,h,w,k,z,A,C,x,q,S,$,P,B,M,D,F,T,R,O,U,V,E,I,L,j,H,N,Y,W,G,J,Z,K,Q,X,ee,ae,le,te,re,se,oe,ne,ie,de,ue,ce,fe,me,be,pe,ve,ge,_e,ye,he,we,ke,ze,Ae,Ce,xe,qe,Se,$e,Pe,Be,Me,De,Fe;return{setters:[e=>{l=e.openBlock,t=e.createElementBlock,r=e.unref,s=e.createElementVNode,o=e.renderSlot,n=e.defineComponent,i=e.Fragment,d=e.toDisplayString,u=e.createVNode,c=e.normalizeClass,f=e.ref,m=e.onMounted,b=e.mergeProps,p=e.createBlock,v=e.withCtx,g=e.createCommentVNode,_=e.computed,y=e.createTextVNode,h=e.renderList,w=e.readonly,k=e.watchEffect,z=e.resolveComponent,A=e.watchPostEffect,C=e.Teleport,x=e.withModifiers,q=e.createApp},e=>{S=e.y,$=e.C,P=e.bj,B=e.G,M=e._,D=e.b,F=e.d,T=e.bk,R=e.af,O=e.z,U=e.I,V=e.D,E=e.F,I=e.b3,L=e.bl,j=e.bm,H=e.ao,N=e.b7,Y=e.bn,W=e.bo,G=e.ak,J=e.J,Z=e.ab,K=e.bp,Q=e.aL,X=e.X,ee=e.a$,ae=e.bq,le=e.br,te=e.U,re=e.a5,se=e.aI,oe=e.bs,ne=e.ap,ie=e.W,de=e.$,ue=e.bt,ce=e.bu,fe=e.aD,me=e.bv,be=e.bw,pe=e.bx,ve=e.by,ge=e.bz,_e=e.bA,ye=e.bB,he=e.bC,we=e.b2,ke=e.bD,ze=e.bE,Ae=e.b9,Ce=e.bc,xe=e.aK,qe=e.bd,Se=e.be,$e=e.bf,Pe=e.bF,Be=e.bG,Me=e.bg,De=e.bh,Fe=e.bi},null,null],execute:function(){const e=["aria-label"],a={class:"fr-breadcrumb__list"},Te={__name:"Breadcrumb",setup(n){const{t:i}=S();return(n,d)=>(l(),t("nav",{rol:"navigation","aria-label":r(i)("You're here:"),class:"fr-breadcrumb fr-mb-5v"},[s("ol",a,[o(n.$slots,"default")])],8,e))}},Re={class:"fr-text--sm fr-my-0"},Oe={class:"fr-grid-row fr-grid-row--right not-enlarged"},Ue=["href","title"],Ve=n({__name:"QualityScoreTooltipContent",props:{dataset:{}},setup(e){const{t:a}=S();return(e,o)=>(l(),t(i,null,[s("h5",Re,d(r(a)("Metadata quality:")),1),u(r($),{passed:e.dataset.quality.dataset_description_quality,messagePassed:r(a)("Data description filled"),messageFailed:r(a)("Data description empty"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),u(r($),{passed:e.dataset.quality.resources_documentation,messagePassed:r(a)("Files documented"),messageFailed:r(a)("Files documentation missing"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),u(r($),{passed:e.dataset.quality.license,messagePassed:r(a)("License filled"),messageFailed:r(a)("No license set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),u(r($),{passed:e.dataset.quality.update_frequency&&!!e.dataset.quality.update_fulfilled_in_time,messagePassed:r(a)("Update frequency followed"),messageFailed:e.dataset.quality.update_frequency?r(a)("Update frequency not followed"):r(a)("Update frequency not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),u(r($),{passed:e.dataset.quality.has_open_format,messagePassed:r(a)("File formats are open"),messageFailed:r(a)("File formats are closed"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),u(r($),{passed:e.dataset.quality.temporal_coverage,messagePassed:r(a)("Temporal coverage filled"),messageFailed:r(a)("Temporal coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),u(r($),{passed:e.dataset.quality.spatial,messagePassed:r(a)("Spatial coverage filled"),messageFailed:r(a)("Spatial coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),u(r($),{passed:e.dataset.quality.all_resources_available,messagePassed:r(a)("All files are available"),messageFailed:r(a)("Some files are unavailable"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),s("div",Oe,[s("a",{href:r(P),target:"_blank",rel:"noopener",title:r(a)("Learn more about this indicator - opens a new window")},d(r(a)("Learn more about this indicator")),9,Ue)])],64))}}),Ee=n({__name:"AdminBadge",props:{type:{}},setup:e=>(e,a)=>(l(),t("p",{class:c(["fr-badge",{"fr-badge--blue-cumulus":"info"===e.type,"fr-badge--error fr-badge--no-icon":"error"===e.type,"fr-badge--warning fr-badge--no-icon":"warning"===e.type,"fr-badge--success fr-badge--no-icon":"success"===e.type}])},[o(e.$slots,"default")],2))}),Ie=["aria-describedby"],Le=["id"],je=M(n({inheritAttrs:!1,__name:"AdminContentWithTooltip",setup(e){const a=B(),n=f(),u=f("");return m((()=>{n.value&&(u.value=n.value.textContent||"")})),(e,c)=>(l(),t(i,null,[s("p",b(e.$attrs,{"aria-describedby":r(a),ref_key:"contentRef",ref:n}),[o(e.$slots,"default",{},void 0,!0)],16,Ie),s("span",{class:"fr-hidden-xl fr-tooltip fr-placement",id:r(a),role:"tooltip","aria-hidden":"true"},d(u.value),9,Le)],64))}}),[["__scopeId","data-v-d192f17a"]]),He=n({__name:"AdminLoader",props:{scale:{default:4}},setup:e=>(D(T),(e,a)=>(l(),p(r(F),{name:"ri-loader-5-line",animation:"spin",scale:e.scale,fill:"var(--blue-cumulus-sun-368-moon-732)"},null,8,["scale"])))}),Ne={class:"fr-table fr-mb-2w"},Ye=n({__name:"AdminTable",props:{loading:{type:Boolean,default:!1}},setup:e=>(e,a)=>(l(),t("div",Ne,[s("table",null,[o(e.$slots,"default",{},void 0,!0)]),e.loading?(l(),p(R,{key:0,class:"fr-p-4w text-align-center"},{default:v((()=>[u(He)])),_:1})):g("",!0)]))}),We=M(Ye,[["__scopeId","data-v-cae574a4"]]),Ge={class:"fr-text--bold"},Je={key:1,class:"fr-grid-row fr-grid-row--middle justify-between"},Ze=["title"],Ke=M(n({__name:"AdminTableTh",props:{sorted:{}},emits:["sort"],setup(e,{emit:a}){const n=e,i=a,{t:u}=S(),f=_((()=>void 0!==n.sorted));function m(){return"desc"===n.sorted?i("sort","asc"):i("sort","desc")}return(e,a)=>(l(),t("th",Ge,[f.value?(l(),t("div",Je,[o(e.$slots,"default",{},void 0,!0),s("button",{class:c(["fr-ml-1w fr-btn fr-btn--sm fr-btn--tertiary-no-outline",{"fr-icon-arrow-down-line":!e.sorted||"asc"===e.sorted,"fr-icon-arrow-up-line":"desc"===e.sorted,"text-grey-500":e.sorted,"text-mention-grey":!e.sorted}]),onClick:m,title:r(u)("Sort")},d(r(u)("Sort")),11,Ze)])):o(e.$slots,"default",{key:0},void 0,!0)]))}}),[["__scopeId","data-v-5acf0bf0"]]),Qe=["aria-describedby"],Xe=["id"],ea=n({__name:"Tooltip",setup(e){const a=B("tooltip");return(e,n)=>(l(),t(i,null,[s("p",b(e.$attrs,{"aria-describedby":r(a)}),[o(e.$slots,"default")],16,Qe),s("span",{class:"fr-tooltip fr-placement",id:r(a),role:"tooltip","aria-hidden":"true"},[o(e.$slots,"tooltip")],8,Xe)],64))}}),aa=["href"],la={class:"monospace"},ta={class:"monospace"},ra={class:"monospace"},sa={class:"monospace"},oa={class:"monospace"},na=n({__name:"AdminDatasetsTable",props:{datasets:{},loading:{type:Boolean},sortDirection:{},sortedBy:{}},emits:["sort"],setup(e,{emit:a}){const o=a,n=e,{t:c}=S();function f(e,a){o("sort",e,a)}function m(e){return n.sortedBy===e?n.sortDirection:null}function b(e){return Array.isArray(e.resources)?e.resources.length:e.resources.total}function g(e){return`${I}dataset/${e.id}/`}function _(e){return e.deleted?{label:c("Deleted"),type:"error"}:e.archived?{label:c("Archived"),type:"warning"}:e.private?{label:c("Private"),type:"default"}:{label:c("Public"),type:"info"}}return(e,a)=>(l(),p(We,{loading:e.loading},{default:v((()=>[s("thead",null,[s("tr",null,[u(Ke,{onSort:a[0]||(a[0]=e=>f("title",e)),sorted:m("title"),scope:"col"},{default:v((()=>[y(d(r(c)("Title of the dataset")),1)])),_:1},8,["sorted"]),u(Ke,{scope:"col"},{default:v((()=>[y(d(r(c)("Status")),1)])),_:1}),u(Ke,{onSort:a[1]||(a[1]=e=>f("created",e)),sorted:m("created"),scope:"col"},{default:v((()=>[y(d(r(c)("Created at")),1)])),_:1},8,["sorted"]),u(Ke,{onSort:a[2]||(a[2]=e=>f("last_update",e)),sorted:m("last_update"),scope:"col"},{default:v((()=>[y(d(r(c)("Updated at")),1)])),_:1},8,["sorted"]),u(Ke,{scope:"col"},{default:v((()=>[y(d(r(c)("Files")),1)])),_:1}),u(Ke,{scope:"col"},{default:v((()=>[y(d(r(c)("Score")),1)])),_:1}),u(Ke,{scope:"col"},{default:v((()=>[u(ea,null,{tooltip:v((()=>[y(d(r(c)("Discussions")),1)])),default:v((()=>[a[6]||(a[6]=s("span",{class:"fr-icon--sm fr-icon-chat-3-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1}),u(Ke,{onSort:a[3]||(a[3]=e=>f("views",e)),sorted:m("views"),scope:"col"},{default:v((()=>[u(ea,null,{tooltip:v((()=>[y(d(r(c)("Views")),1)])),default:v((()=>[a[7]||(a[7]=s("span",{class:"fr-icon--sm fr-icon-eye-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1},8,["sorted"]),u(Ke,{scope:"col"},{default:v((()=>[u(ea,null,{tooltip:v((()=>[y(d(r(c)("Downloads")),1)])),default:v((()=>[a[8]||(a[8]=s("span",{class:"fr-icon--sm fr-icon-download-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1}),u(Ke,{onSort:a[4]||(a[4]=e=>f("reuses",e)),sorted:m("reuses"),scope:"col"},{default:v((()=>[u(ea,null,{tooltip:v((()=>[y(d(r(c)("Reuses")),1)])),default:v((()=>[a[9]||(a[9]=s("span",{class:"fr-icon--sm fr-icon-line-chart-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1},8,["sorted"]),u(Ke,{onSort:a[5]||(a[5]=e=>f("followers",e)),sorted:m("followers"),scope:"col"},{default:v((()=>[u(ea,null,{tooltip:v((()=>[y(d(r(c)("Favorites")),1)])),default:v((()=>[a[10]||(a[10]=s("span",{class:"fr-icon--sm fr-icon-star-s-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1},8,["sorted"])])]),s("tbody",null,[(l(!0),t(i,null,h(e.datasets,(e=>{var a;return l(),t("tr",{key:e.id},[s("td",null,[u(je,null,{default:v((()=>[s("a",{class:"fr-link fr-reset-link",href:g(e)},[u(r(O),{text:e.title,"auto-resize":!0,"max-lines":2},null,8,["text"])],8,aa)])),_:2},1024)]),s("td",null,[u(Ee,{type:_(e).type},{default:v((()=>[y(d(_(e).label),1)])),_:2},1032,["type"])]),s("td",null,d(r(U)(e.created_at)),1),s("td",null,d(r(U)(e.last_modified)),1),s("td",null,d(b(e)),1),s("td",null,[u(ea,null,{tooltip:v((()=>[u(Ve,{dataset:e},null,8,["dataset"])])),default:v((()=>[u(r(V),{class:"w-100",score:e.quality.score},null,8,["score"])])),_:2},1024)]),s("td",la,d(r(E)(e.metrics.discussions)),1),s("td",ta,d(r(E)(e.metrics.views)),1),s("td",ra,d(r(E)(null!==(a=e.metrics.resources_downloads)&&void 0!==a?a:0)),1),s("td",sa,d(r(E)(e.metrics.reuses)),1),s("td",oa,d(r(E)(e.metrics.followers)),1)])})),128))])])),_:1},8,["loading"]))}}),ia=f(null);function da(){return{currentOrganization:w(ia),setCurrentOrganization:e=>{ia.value=e}}}const ua=["href"],ca=["src","alt"],fa=n({__name:"AdminPublishButton",props:{type:{}},setup(e){const a=e,{t:o}=S(),n=_((()=>{switch(a.type){case"dataset":return j;case"reuse":return L}}));return(e,a)=>(l(),t("a",{href:n.value,class:"fr-btn fr-icon-add-line fr-btn--icon-left"},[y(d(r(o)("Publish on"))+" ",1),s("img",{class:"fr-ml-1v",src:r("/_themes/gouvfr/assets/logotype-white.svg"),loading:"lazy",alt:r(H)},null,8,ca)],8,ua))}}),ma={key:0},ba={class:"fr-breadcrumb__link","aria-current":"page"},pa={class:"fr-h3 fr-mb-5v"},va={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},ga={class:"fr-col"},_a={class:"subtitle subtitle--uppercase fr-m-0"},ya={key:0,class:"fr-col-auto fr-grid-row fr-grid-row--middle"},ha=["href"],wa={class:"text-align-center fr-py-1w"},ka=["src"],za={class:"fr-text--bold fr-my-3v"},Aa=n({__name:"Datasets",props:{oid:{}},setup(e){const{t:a}=S(),o=e,n=f([]),i=f(!1),c=f(1),m=f(10),b=f(0),h=f("created"),w=f("asc"),A=_((()=>`${"asc"===w.value?"":"-"}${h.value}`)),C=f(""),x=N(C,Z),{currentOrganization:q}=da();function $(e,a){h.value=e,w.value=a}return k((async()=>{i.value=!0,n.value=[];try{const e=await Y(o.oid,x.value,c.value,m.value,A.value);n.value=e.data,c.value=e.page,m.value=e.page_size,b.value=e.total}finally{i.value=!1}})),(e,o)=>{const f=z("router-link");return l(),t("div",null,[u(Te,null,{default:v((()=>[s("li",null,[u(f,{class:"fr-breadcrumb__link",to:"/"},{default:v((()=>[y(d(r(a)("Administration")),1)])),_:1})]),r(q)?(l(),t("li",ma,[u(f,{class:"fr-breadcrumb__link",to:"/"},{default:v((()=>[y(d(r(q).name),1)])),_:1})])):g("",!0),s("li",null,[s("a",ba,d(r(a)("Datasets")),1)])])),_:1}),s("h1",pa,d(r(a)("Datasets")),1),s("div",va,[s("div",ga,[s("h2",_a,d(r(a)("{n} datasets",b.value)),1)]),b.value?(l(),t("div",ya,[s("div",null,[s("a",{href:r(W)(e.oid),class:"fr-btn fr-btn--sm fr-icon-download-line fr-btn--icon-left"},d(r(a)("Download catalog")),9,ha)])])):g("",!0)]),i.value||b.value>0?(l(),p(na,{key:0,datasets:n.value,loading:i.value,"sort-direction":w.value,sortedBy:h.value,onSort:$},null,8,["datasets","loading","sort-direction","sortedBy"])):(l(),p(R,{key:1,class:"fr-my-2w"},{default:v((()=>[s("div",wa,[s("img",{src:r(G),alt:"",loading:"lazy"},null,8,ka),s("p",za,d(r(a)("You haven't published a dataset yet")),1),u(fa,{type:"dataset"})])])),_:1})),b.value>m.value?(l(),p(r(J),{key:2,page:c.value,"page-size":m.value,"total-results":b.value,onChange:o[0]||(o[0]=e=>c.value=e)},null,8,["page","page-size","total-results"])):g("",!0)])}}}),Ca=["href"],xa={class:"monospace"},qa={class:"monospace"},Sa={class:"monospace"},$a={class:"monospace"},Pa=n({__name:"AdminReusesTable",props:{reuses:{},loading:{type:Boolean},sortedBy:{},sortDirection:{}},emits:["sort"],setup(e){const a=e,{t:o}=S();function n(e){return a.sortedBy===e?a.sortDirection:null}function c(e){return`${I}reuse/${e.id}/`}function f(e){return e.deleted?{label:o("Deleted"),type:"error"}:e.archived?{label:o("Archived"),type:"warning"}:e.private?{label:o("Private"),type:"default"}:{label:o("Public"),type:"info"}}return(e,a)=>(l(),p(We,{loading:e.loading},{default:v((()=>[s("thead",null,[u(Ke,{onSort:a[0]||(a[0]=a=>e.$emit("sort","title",a)),sorted:n("title"),scope:"col"},{default:v((()=>[y(d(r(o)("Reuse title")),1)])),_:1},8,["sorted"]),u(Ke,null,{default:v((()=>[y(d(r(o)("Status")),1)])),_:1}),u(Ke,{onSort:a[1]||(a[1]=a=>e.$emit("sort","created",a)),sorted:n("created"),scope:"col"},{default:v((()=>[y(d(r(o)("Created at")),1)])),_:1},8,["sorted"]),u(Ke,{onSort:a[2]||(a[2]=a=>e.$emit("sort","datasets",a)),sorted:n("datasets"),scope:"col"},{default:v((()=>[y(d(r(o)("Datasets")),1)])),_:1},8,["sorted"]),u(Ke,{scope:"col"},{default:v((()=>[u(ea,null,{tooltip:v((()=>[y(d(r(o)("Discussions")),1)])),default:v((()=>[a[5]||(a[5]=s("span",{class:"fr-icon--sm fr-icon-chat-3-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1}),u(Ke,{onSort:a[3]||(a[3]=a=>e.$emit("sort","views",a)),sorted:n("views"),scope:"col"},{default:v((()=>[u(ea,null,{tooltip:v((()=>[y(d(r(o)("Views")),1)])),default:v((()=>[a[6]||(a[6]=s("span",{class:"fr-icon--sm fr-icon-eye-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1},8,["sorted"]),u(Ke,{onSort:a[4]||(a[4]=a=>e.$emit("sort","followers",a)),sorted:n("followers"),scope:"col"},{default:v((()=>[u(ea,null,{tooltip:v((()=>[y(d(r(o)("Favorites")),1)])),default:v((()=>[a[7]||(a[7]=s("span",{class:"fr-icon--sm fr-icon-star-s-line","aria-hidden":"true"},null,-1))])),_:1})])),_:1},8,["sorted"])]),s("tbody",null,[(l(!0),t(i,null,h(e.reuses,(e=>(l(),t("tr",null,[s("td",null,[u(je,null,{default:v((()=>[s("a",{class:"fr-link fr-reset-link",href:c(e)},[u(r(O),{text:e.title,"auto-resize":!0,"max-lines":2},null,8,["text"])],8,Ca)])),_:2},1024)]),s("td",null,[u(Ee,{type:f(e).type},{default:v((()=>[y(d(f(e).label),1)])),_:2},1032,["type"])]),s("td",null,d(r(U)(e.created_at)),1),s("td",xa,d(r(E)(e.datasets.length)),1),s("td",qa,d(r(E)(e.metrics.discussions)),1),s("td",Sa,d(r(E)(e.metrics.views)),1),s("td",$a,d(r(E)(e.metrics.followers)),1)])))),256))])])),_:1},8,["loading"]))}}),Ba={class:"fr-container--fluid"},Ma={key:0},Da={class:"fr-breadcrumb__link","aria-current":"page"},Fa={class:"fr-h3"},Ta={class:"subtitle subtitle--uppercase"},Ra={class:"text-align-center fr-py-1w"},Oa=["src"],Ua={class:"fr-text--bold fr-my-3v"},Va=n({__name:"Reuses",props:{oid:{}},setup(e){const{t:a}=S(),o=e,n=f([]),i=f(!1),c=f(1),m=f(10),b=f(0),h=f("created"),w=f("asc"),A=_((()=>`${"asc"===w.value?"":"-"}${h.value}`)),{currentOrganization:C}=da();function x(e,a){h.value=e,w.value=a}return k((async()=>{i.value=!0,n.value=[];try{const e=await K(o.oid,c.value,m.value,A.value);n.value=e.data,c.value=e.page,m.value=e.page_size,b.value=e.total}finally{i.value=!1}})),(e,o)=>{const f=z("router-link");return l(),t("div",Ba,[u(Te,null,{default:v((()=>[s("li",null,[u(f,{class:"fr-breadcrumb__link",to:"/"},{default:v((()=>[y(d(r(a)("Administration")),1)])),_:1})]),r(C)?(l(),t("li",Ma,[u(f,{class:"fr-breadcrumb__link",to:"/"},{default:v((()=>[y(d(r(C).name),1)])),_:1})])):g("",!0),s("li",null,[s("a",Da,d(r(a)("Reuses")),1)])])),_:1}),s("h1",Fa,d(r(a)("Reuses")),1),s("h2",Ta,d(r(a)("{n} reuses of your organization",n.value.length)),1),i.value||b.value>0?(l(),p(Pa,{key:0,reuses:n.value,loading:i.value,sortDirection:w.value,sortedBy:h.value,onSort:x},null,8,["reuses","loading","sortDirection","sortedBy"])):(l(),p(R,{key:1,class:"fr-mt-1w fr-mb-2w"},{default:v((()=>[s("div",Ra,[s("img",{src:r("/_themes/gouvfr/assets/reuse.svg"),alt:"",loading:"lazy"},null,8,Oa),s("p",Ua,d(r(a)("You haven't published a reuse yet")),1),u(fa,{type:"reuse"})])])),_:1})),b.value>m.value?(l(),p(r(J),{key:2,page:c.value,"page-size":m.value,"total-results":b.value,onChange:o[0]||(o[0]=e=>c.value=e)},null,8,["page","page-size","total-results"])):g("",!0)])}}}),Ea={class:"fr-breadcrumb__link","aria-current":"page"},Ia={key:0,class:"fr-h1"},La={class:"fr-alert fr-alert--info"},ja={class:"fr-alert__title"},Ha={href:"/admin/me/"},Na=n({__name:"Me",setup(e){const{t:a}=S(),o=f(null);return m((async()=>o.value=await Q())),(e,n)=>{const i=z("router-link");return l(),t("div",null,[u(Te,null,{default:v((()=>[s("li",null,[u(i,{class:"fr-breadcrumb__link",to:"/"},{default:v((()=>[y(d(r(a)("Administration")),1)])),_:1})]),s("li",null,[s("a",Ea,d(r(a)("Me")),1)])])),_:1}),o.value?(l(),t("h1",Ia,d(o.value.first_name)+" "+d(o.value.last_name),1)):g("",!0),s("div",La,[s("h3",ja,d(r(a)("This is a WIP page")),1),s("p",null,[s("a",Ha,d(r(a)("You can edit your profil on the current admin.")),1)])])])}}}),Ya={class:"fr-sidemenu__item"},Wa=["innerHTML"],Ga=M(n({__name:"AdminSidebarLink",props:{label:{},icon:{},iconHtml:{},to:{}},setup:e=>(e,a)=>{const r=z("router-link");return l(),t("li",Ya,[s("div",{class:c([{"fr-icon-svg fr-icon--sm":e.iconHtml},"fr-enlarge-link fr-sidemenu__link fr-mb-1w"])},[e.iconHtml?(l(),t("div",{key:0,class:"fr-mr-1w fr-grid-row",innerHTML:e.iconHtml},null,8,Wa)):e.icon?(l(),t("div",{key:1,class:c([e.icon,"fr-mr-1w fr-icon--sm"]),"aria-hidden":"true"},null,2)):g("",!0),u(r,{to:e.to},{default:v((()=>[y(d(e.label),1)])),_:1},8,["to"])],2)])}}),[["__scopeId","data-v-5e2ff0a8"]]),Ja=["aria-expanded","aria-controls","aria-current"],Za={class:"fr-mx-1w"},Ka={class:"logo logo--sm"},Qa={class:"fr-mx-1w fr-col text-overflow-ellipsis"},Xa=["id"],el={class:"fr-sidemenu__list fr-mx-1w fr-my-3v"},al=n({__name:"AdminSidebarMenu",props:{user:{},organization:{},isOpened:{type:Boolean}},emits:["open","click"],setup(e){const a=e,{t:o}=S(),n=B("menu");return A((()=>{setTimeout((()=>{!function(e,a){const l=document.getElementById(n);a(l)&&(e?a(l).collapse.disclose():a(l).collapse.conceal())}(a.isOpened,globalThis.dsfr)}),200)})),(e,a)=>(l(),t("li",{class:c(["fr-sidemenu__item",{"fr-sidemenu__item--active":e.isOpened}])},[s("button",{class:"fr-sidemenu__btn","aria-expanded":e.isOpened,"aria-controls":r(n),"aria-current":e.isOpened,onClick:a[0]||(a[0]=a=>e.$emit("open"))},[e.user?(l(),t(i,{key:0},[e.user?(l(),p(X,{key:0,user:e.user,size:24,rounded:!0},null,8,["user"])):g("",!0),s("p",Za,d(r(o)("My Profil")),1)],64)):e.organization?(l(),t(i,{key:1},[s("div",Ka,[u(ee,{type:"organization",src:e.organization.logo_thumbnail,size:20},null,8,["src"])]),s("p",Qa,d(e.organization.name),1)],64)):g("",!0)],8,Ja),s("div",{class:"fr-collapse","data-fr-js-collapse":"",id:r(n)},[s("ul",el,[e.user?(l(),p(Ga,{key:0,icon:"fr-icon-account-circle-line",label:r(o)("Me"),to:"/me"},null,8,["label"])):e.organization?(l(),t(i,{key:1},[u(Ga,{iconHtml:r('<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M5 12V18C5 18 5 21 12 21C19 21 19 18 19 18V12" stroke="currentColor" stroke-width="1.5"/>\n<path d="M5 6V12C5 12 5 15 12 15C19 15 19 12 19 12V6" stroke="currentColor" stroke-width="1.5"/>\n<path d="M12 3C19 3 19 6 19 6C19 6 19 9 12 9C5 9 5 6 5 6C5 6 5 3 12 3Z" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'),label:r(o)("Datasets"),to:{name:"organization-datasets",params:{oid:e.organization.id}},onClick:a[1]||(a[1]=a=>e.$emit("click"))},null,8,["iconHtml","label","to"]),u(Ga,{icon:"fr-icon-line-chart-line",label:r(o)("Reuses"),to:{name:"organization-reuses",params:{oid:e.organization.id}},onClick:a[2]||(a[2]=a=>e.$emit("click"))},null,8,["label","to"]),u(Ga,{icon:"fr-icon-parent-line",label:r(o)("Members"),to:{name:"organization-members",params:{oid:e.organization.id}}},null,8,["label","to"]),u(Ga,{icon:"fr-icon-user-line",label:r(o)("Profile"),to:{name:"organization-profile",params:{oid:e.organization.id}}},null,8,["label","to"])],64)):g("",!0)])],8,Xa)],2))}}),ll=M(al,[["__scopeId","data-v-352caa70"]]),tl={class:"fr-container--fluid h-100"},rl={class:"fr-grid-row h-100 bg-grey-50"},sl={class:"fr-col-12 fr-col-md-4 fr-col-lg-3 fr-col-xl-2"},ol=["aria-label"],nl={class:"fr-sidemenu__inner"},il=["aria-controls"],dl=["id"],ul={class:"fr-sidemenu__list"},cl={class:"fr-col-12 fr-col-md-8 fr-col-lg-9 fr-col-xl-10 h-100 fr-px-2w"},fl=n({__name:"Admin",setup(e){const{t:a}=S(),o=ae(),n=B("menu"),u=f(null),c=f(),{setCurrentOrganization:b}=da(),v=le();function _(e){return e===c.value}function y(e){c.value=e.id}return m((async()=>{var e;if(u.value=await Q(),o.name||(u.value.organizations.length>0?v.replace({name:"organization-datasets",params:{oid:u.value.organizations[0].id}}):v.replace({name:"me"})),"me"===o.name)c.value=null===(e=te)||void 0===e?void 0:e.id;else if(u.value.organizations.length>0){let e=u.value.organizations[0];var a;o.params.oid&&(e=null!==(a=u.value.organizations.find((e=>e.id===o.params.oid)))&&void 0!==a?a:e),y(e),b(e)}})),(e,c)=>{const f=z("router-view");return l(),t("div",tl,[s("div",rl,[s("div",sl,[s("nav",{class:"fr-sidemenu fr-pr-0","aria-label":r(a)("Administration menu")},[s("div",nl,[s("button",{class:"fr-sidemenu__btn",hidden:"","aria-controls":r(n),"aria-expanded":"false"},d(r(a)("Open menu")),9,il),s("div",{class:"fr-collapse",id:r(n)},[s("ul",ul,[r(te)?(l(),p(ll,{key:0,user:r(te),"is-opened":_(r(te).id),onOpen:c[0]||(c[0]=e=>y(r(te)))},null,8,["user","is-opened"])):g("",!0),u.value?(l(!0),t(i,{key:1},h(u.value.organizations,(e=>(l(),p(ll,{organization:e,"is-opened":_(e.id),onOpen:()=>y(e),onClick:()=>r(b)(e)},null,8,["organization","is-opened","onOpen","onClick"])))),256)):g("",!0)])],8,dl)])],8,ol)]),s("div",cl,[(l(),p(f,{key:r(o).fullPath,class:"fr-container--fluid"}))])])])}}}),ml=M(fl,[["__scopeId","data-v-1057ebbe"]]),bl=["aria-labelledby","id"],pl={class:"fr-container fr-container--fluid fr-container-md"},vl={class:"fr-grid-row fr-grid-row--center"},gl={class:"fr-col-12 fr-col-md-8"},_l={class:"fr-modal__body"},yl={class:"fr-modal__header"},hl=["title","aria-controls"],wl={class:"fr-modal__content"},kl=["id"],zl={class:"fr-modal__footer"},Al={class:"fr-btns-group fr-btns-group--right fr-btns-group--sm fr-btns-group--inline-lg fr-btns-group--icon-left"},Cl=["disabled"],xl=["disabled"],ql=n({__name:"AdminAddMemberModal",props:{id:{},oid:{},roles:{}},emits:["memberAdded"],setup(e,{emit:a}){const t=e,o=a,{t:n}=S(),{toast:i}=ie(),c=f(!1),m=f(),b=f("editor"),v=_((()=>"fr-modal-title-user-"+t.id));async function y(){try{c.value=!0,m.value&&(await oe(t.oid,m.value,b.value),o("memberAdded"),w())}catch(e){i.error(n("An error occurred while update member role."))}finally{c.value=!1}}function h(e){return e.map((e=>{var a;const l={...e,avatar_thumbnail:null!==(a=e.avatar_url)&&void 0!==a?a:void 0};return{value:l.id,label:l.first_name+" "+l.last_name,image:ne(l,32)}}))}function w(){c.value=!1,m.value=void 0,b.value="editor";const e=document.getElementById(t.id);globalThis.dsfr(e).modal.conceal()}return(e,a)=>(l(),p(C,{to:"body"},[s("dialog",{"aria-labelledby":v.value,role:"dialog",id:e.id,class:"fr-modal"},[s("div",pl,[s("div",vl,[s("div",gl,[s("div",_l,[s("div",yl,[s("button",{class:"fr-btn--close fr-btn",title:r(n)("Close the modal dialog"),"aria-controls":e.id},d(r(n)("Close")),9,hl)]),s("form",{onSubmit:x(y,["prevent"])},[s("div",wl,[s("h1",{id:v.value,class:"fr-modal__title fr-mb-2w"},d(r(n)("Add member to the organization")),9,kl),u(re,{placeholder:e.$t("Search a user"),searchPlaceholder:e.$t("Search a user..."),suggestUrl:"/users/suggest/",values:m.value,onChange:a[0]||(a[0]=e=>m.value=e),allOption:e.$t("Select a user"),addAllOption:!1,onSuggest:h,roundedImages:!0},null,8,["placeholder","searchPlaceholder","values","allOption"]),e.roles.length>0?(l(),p(se,{key:0,label:r(n)("Role of the member"),"model-value":b.value,"onUpdate:modelValue":a[1]||(a[1]=e=>b.value=e),options:e.roles},null,8,["label","model-value","options"])):g("",!0)]),s("div",zl,[s("div",Al,[s("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",type:"button",onClick:w,disabled:c.value},d(r(n)("Cancel")),9,Cl),s("button",{class:"fr-btn",type:"submit",disabled:c.value},d(r(n)("Add to the organization")),9,xl)])])],32)])])])])],8,bl)]))}}),Sl=["aria-controls"],$l=n({__name:"AdminAddMemberButton",props:{oid:{},roles:{}},emits:["memberAdded"],setup(e){const a=e,{t:o}=S(),n=_((()=>"fr-modal-add-user-"+a.oid));return(e,a)=>(l(),t(i,null,[s("button",{class:"fr-btn fr-btn--sm fr-btn--icon-left fr-icon-add-line","data-fr-opened":"false","aria-controls":n.value},d(r(o)("Add member")),9,Sl),u(ql,{id:n.value,oid:e.oid,roles:e.roles,onMemberAdded:a[0]||(a[0]=a=>e.$emit("memberAdded"))},null,8,["id","oid","roles"])],64))}}),Pl={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},Bl=n({__name:"AdminDangerZone",setup:e=>(e,a)=>(l(),p(r(de),{color:"error",type:"secondary",weight:"regular"},{default:v((()=>[s("div",Pl,[o(e.$slots,"default")])])),_:3}))}),Ml=["aria-labelledby","id"],Dl={class:"fr-container fr-container--fluid fr-container-md"},Fl={class:"fr-grid-row fr-grid-row--center"},Tl={class:"fr-col-12 fr-col-md-8"},Rl={class:"fr-modal__body"},Ol={class:"fr-modal__header"},Ul=["title","aria-controls"],Vl={class:"fr-modal__content"},El=["id"],Il={class:"fr-grid-row fr-grid-row--middle fr-text--bold fr-mb-2w"},Ll={class:"fr-col"},jl={class:"fr-col-auto"},Hl=["disabled"],Nl={class:"fr-col"},Yl={class:"fr-m-0 text-grey-500"},Wl={class:"fr-m-0 fr-text--xs text-default-error"},Gl={class:"fr-col-auto"},Jl=["disabled"],Zl=n({__name:"AdminEditMemberModal",props:{id:{},member:{},oid:{},roles:{}},emits:["memberUpdated"],setup(e,{emit:a}){const t=e,o=a,n=_((()=>"fr-modal-title-user-"+t.id)),{t:i}=S(),{toast:c}=ie(),m=f(!1);function b(){m.value=!1;const e=document.getElementById(t.id);globalThis.dsfr(e).modal.conceal()}return(e,a)=>{return l(),p(C,{to:"body"},[s("dialog",{"aria-labelledby":n.value,role:"dialog",id:e.id,class:"fr-modal"},[s("div",Dl,[s("div",Fl,[s("div",Tl,[s("div",Rl,[s("div",Ol,[s("button",{class:"fr-btn--close fr-btn",title:r(i)("Close the modal dialog"),"aria-controls":e.id},d(r(i)("Close")),9,Ul)]),s("div",Vl,[s("h1",{id:n.value,class:"fr-modal__title fr-mb-2w"},d(r(i)("Edit member")),9,El),s("p",Il,[u(X,{class:"fr-mr-1v",user:e.member.user,rounded:!0,size:24},null,8,["user"]),y(" "+d(e.member.user.first_name)+" "+d(e.member.user.last_name),1)]),s("form",{class:"fr-grid-row fr-grid-row--gutters fr-grid-row--bottom",onSubmit:a[1]||(a[1]=x((a=>async function(e){if(e.newRole)try{m.value=!0,await ue(t.oid,e.user.id,e.newRole),o("memberUpdated"),b()}catch(a){c.error(i("An error occurred while update member role."))}finally{m.value=!1}else b()}(e.member)),["prevent"]))},[s("div",Ll,[e.roles.length>0?(l(),p(se,{key:0,label:r(i)("Role of the member"),"model-value":e.member.role,"onUpdate:modelValue":a[0]||(a[0]=a=>e.member.newRole=a),options:(f=e.member.role,t.roles.map((e=>{const a={...e};return a.value===f&&(a.selected=!0),a})))},null,8,["label","model-value","options"])):g("",!0)]),s("div",jl,[s("button",{class:"fr-btn",type:"submit",disabled:m.value},d(r(i)("Validate")),9,Hl)])],32),u(Bl,{class:"fr-mt-2w"},{default:v((()=>[s("div",Nl,[s("p",Yl,d(r(i)("Remove member from the organization")),1),s("p",Wl,d(r(i)("Be careful, this action can't be reverse.")),1)]),s("div",Gl,[s("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error fr-btn--icon-left fr-icon-logout-box-r-line",disabled:m.value,onClick:a[2]||(a[2]=a=>async function(e){try{m.value=!0,await ce(t.oid,e.user.id),o("memberUpdated")}catch(a){c.error(i("An error occurred while removing this member."))}finally{m.value=!1}}(e.member))},d(r(i)("Remove member")),9,Jl)])])),_:1})])])])])])],8,Ml)]);var f}}}),Kl=["aria-controls"],Ql=n({__name:"AdminEditMemberButton",props:{member:{},oid:{},roles:{}},emits:["memberUpdated"],setup(e){const a=e,{t:o}=S(),n=_((()=>"fr-modal-user-"+a.member.user.id));return(e,a)=>(l(),t(i,null,[s("button",{class:"fr-btn fr-btn--sm fr-btn--tertiary-no-outline fr-icon-pencil-line","data-fr-opened":"false","aria-controls":n.value},d(r(o)("Edit")),9,Kl),u(Zl,{id:n.value,member:e.member,oid:e.oid,roles:e.roles,onMemberUpdated:a[0]||(a[0]=a=>e.$emit("memberUpdated"))},null,8,["id","member","oid","roles"])],64))}}),Xl={class:"fr-mt-n9v fr-mb-2w"},et={class:"fr-badge fr-badge--info fr-badge--no-icon"},at={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},lt={class:"fr-col"},tt={class:"fr-grid-row fr-grid-row--middle"},rt={class:"fr-ml-3v fr-mt-1-5v fr-mb-0 filet filet-default-grey fr-text--sm"},st={key:0,class:"fr-col-auto fr-grid-row flex-direction-column"},ot=["disabled"],nt=["disabled","aria-controls"],it=["aria-labelledby","id"],dt={class:"fr-container fr-container--fluid fr-container-md"},ut={class:"fr-grid-row fr-grid-row--center"},ct={class:"fr-col-12 fr-col-md-8"},ft={class:"fr-modal__body"},mt={class:"fr-modal__header"},bt=["title","aria-controls"],pt={class:"fr-modal__content"},vt=["id"],gt={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--right"},_t={class:"fr-col-auto"},yt=["disabled"],ht={class:"fr-col-auto"},wt=["disabled"],kt=n({__name:"AdminMembershipRequest",props:{loading:{type:Boolean},oid:{},request:{},showActions:{type:Boolean}},emits:["accept","refuse"],setup(e,{emit:a}){const o=e,n=a,{t:i}=S(),c=f(""),m=B("modal"),b=B("modalTitle");function _(){const e=document.getElementById(m);globalThis.dsfr(e).modal.conceal()}function h(){n("refuse",o.request.id,c.value),_()}function w(){c.value="",_()}return(e,a)=>{const o=z("AdminMembershipRequest",!0);return l(),p(R,{class:"drop-shadow rounded-xxs fr-mt-3w"},{default:v((()=>[s("div",Xl,[s("p",et,[a[2]||(a[2]=s("span",{class:"fr-icon-user-add-line fr-icon--sm","aria-hidden":"true"},null,-1)),y(" "+d(r(i)("Membership Request")),1)])]),s("div",at,[s("div",lt,[s("div",tt,[u(X,{class:"fr-mr-1v",user:e.request.user,rounded:!0,size:24},null,8,["user"]),y(" "+d(r(i)("{fullName} asks to join the organization.",{fullName:e.request.user.first_name+" "+e.request.user.last_name})),1)]),s("div",rt,d(e.request.comment),1)]),e.showActions?(l(),t("div",st,[s("button",{class:"fr-btn fr-btn--sm fr-btn--icon-left fr-mb-1w fr-icon-check-line",onClick:a[0]||(a[0]=a=>e.$emit("accept",e.request.id)),disabled:e.loading,"data-testid":"accept"},d(r(i)("Accept request")),9,ot),s("button",{class:"fr-btn fr-btn--icon-left fr-btn--sm fr-btn--secondary fr-btn--secondary--error fr-icon-close-line",disabled:e.loading,"data-fr-opened":"false","aria-controls":r(m),"data-testid":"refuse"},d(r(i)("Refuse")),9,nt),(l(),p(C,{to:"body"},[s("dialog",{"aria-labelledby":r(b),role:"dialog",id:r(m),class:"fr-modal","data-testid":"modal"},[s("div",dt,[s("div",ut,[s("div",ct,[s("div",ft,[s("div",mt,[s("button",{class:"fr-btn--close fr-btn",title:r(i)("Close the modal dialog"),"aria-controls":r(m),onClick:x(w,["prevent"])},d(r(i)("Close")),9,bt)]),s("div",pt,[s("h1",{id:r(b),class:"fr-modal__title fr-mb-2w"},d(r(i)("Refuse membership request")),9,vt),u(o,{class:"fr-mt-4w fr-mb-2w",loading:!1,oid:e.oid,request:e.request,"show-actions":!1},null,8,["oid","request"]),s("form",{onSubmit:x(h,["prevent"]),onReset:w},[u(fe,{label:r(i)("You can provide the refusal reason:"),modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=e=>c.value=e),"data-testid":"comment-group"},null,8,["label","modelValue"]),s("div",gt,[s("div",_t,[s("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",type:"reset",disabled:e.loading,"data-testid":"cancel-modal-button"},d(r(i)("Cancel")),9,yt)]),s("div",ht,[s("button",{class:"fr-btn",type:"submit",disabled:e.loading,"data-testid":"refuse-modal-button"},d(r(i)("Refuse request")),9,wt)])])],32)])])])])])],8,it)]))])):g("",!0)])])),_:1})}}}),zt={key:0},At={class:"fr-breadcrumb__link","aria-current":"page"},Ct={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-center"},xt={class:"fr-col-12 fr-col-md"},qt={class:"fr-h1 fr-mb-2w"},St={key:0,class:"fr-col-auto"},$t={class:"subtitle subtitle--uppercase"},Pt={class:"subtitle subtitle--uppercase fr-mt-2w fr-mb-1v"},Bt={class:"fr-table fr-table--layout-fixed"},Mt={scope:"col"},Dt={scope:"col"},Ft={scope:"col"},Tt={scope:"col"},Rt={scope:"col"},Ot={key:0,scope:"col"},Ut={class:"fr-badge"},Vt={key:0},Et={key:1},It={key:0},Lt=n({__name:"Members",props:{oid:{}},setup(e){const a=e,{t:o}=S(),{toast:n}=ie(),c=f([]),b=_((()=>me||C.value.some((e=>{var a;return e.user.id===(null===(a=te)||void 0===a?void 0:a.id)&&"admin"===e.role})))),w=f([]),{currentOrganization:A}=da(),C=f([]),x=f(!1);async function q(){const e=await _e(a.oid);C.value=e.members}async function $(){const e=await be(a.oid);c.value=e}async function P(e){x.value=!0;const l=[];try{await ye(a.oid,e),l.push($()),l.push(q())}catch(t){n.error(o("An error occurred while accepting this membership."))}finally{Promise.all(l).finally((()=>x.value=!1))}}async function B(e,l){x.value=!0;const t=[];try{await he(a.oid,e,l),t.push($()),t.push(q())}catch(r){n.error(o("An error occurred while refusing this membership."))}finally{Promise.all(t).finally((()=>x.value=!1))}}return k((()=>{b.value&&be(a.oid).then((e=>c.value=e))})),m((()=>{pe().then(ve).then((e=>w.value=e)),q()})),(e,a)=>{const n=z("router-link");return l(),t("div",null,[u(Te,null,{default:v((()=>[s("li",null,[u(n,{class:"fr-breadcrumb__link",to:"/"},{default:v((()=>[y(d(r(o)("Administration")),1)])),_:1})]),r(A)?(l(),t("li",zt,[u(n,{class:"fr-breadcrumb__link",to:"/"},{default:v((()=>[y(d(r(A).name),1)])),_:1})])):g("",!0),s("li",null,[s("a",At,d(r(o)("Members")),1)])])),_:1}),s("div",Ct,[s("div",xt,[s("h1",qt,d(r(o)("Members")),1)]),b.value?(l(),t("div",St,[u($l,{oid:e.oid,roles:w.value,onMemberAdded:q},null,8,["oid","roles"])])):g("",!0)]),c.value.length?(l(),t(i,{key:0},[s("h2",$t,d(r(o)("{n} requests",{n:c.value.length})),1),(l(!0),t(i,null,h(c.value,(a=>(l(),p(kt,{class:"fr-mb-4w",key:a.id,loading:x.value,oid:e.oid,request:a,"show-actions":!0,onAccept:P,onRefuse:B},null,8,["loading","oid","request"])))),128))],64)):g("",!0),s("h2",Pt,d(r(o)("{n} members",{n:C.value.length})),1),s("div",Bt,[s("table",null,[s("thead",null,[s("tr",null,[s("th",Mt,d(r(o)("Members")),1),s("th",Dt,d(r(o)("Email")),1),s("th",Ft,d(r(o)("Status")),1),s("th",Tt,d(r(o)("Member since")),1),s("th",Rt,d(r(o)("Last connection")),1),b.value?(l(),t("th",Ot,d(r(o)("Action")),1)):g("",!0)])]),s("tbody",null,[(l(!0),t(i,null,h(C.value,(a=>{return l(),t("tr",{key:a.user.id},[s("td",null,d(a.user.first_name)+" "+d(a.user.last_name),1),s("td",null,d(a.user.email),1),s("td",null,[s("p",Ut,d((n=a.role,null!==(i=null===(c=w.value.find((e=>e.value===n)))||void 0===c?void 0:c.label)&&void 0!==i?i:n)),1)]),s("td",null,d(r(U)(a.since)),1),s("td",null,[a.user.last_login_at?(l(),t("span",Vt,d(r(ge)(a.user.last_login_at)),1)):(l(),t("span",Et,d(r(o)("No connection")),1))]),b.value?(l(),t("td",It,[u(Ql,{member:a,oid:e.oid,roles:w.value,onMemberUpdated:q},null,8,["member","oid","roles"])])):g("",!0)]);var n,i,c})),128))])])])])}}}),jt={class:"fr-container--fluid"},Ht={key:0},Nt={class:"fr-breadcrumb__link","aria-current":"page"},Yt=["id"],Wt=["disabled","onClick"],Gt={class:"fr-col"},Jt={class:"fr-m-0 text-grey-500"},Zt={class:"fr-m-0 fr-text--xs text-default-error"},Kt={class:"fr-col-auto"},Qt=["disabled","aria-controls"],Xt=["aria-labelledby","id"],er={class:"fr-container fr-container--fluid fr-container-md"},ar={class:"fr-grid-row fr-grid-row--center"},lr={class:"fr-col-12 fr-col-md-8"},tr={class:"fr-modal__body"},rr={class:"fr-modal__header"},sr=["title","aria-controls"],or={class:"fr-modal__content"},nr=["id"],ir={class:"fr-text--bold"},dr={class:"fr-modal__footer"},ur={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left"},cr=["disabled"],fr=n({__name:"Profile",props:{oid:{}},setup(e){const{t:a}=S(),{toast:o}=ie(),n=le(),i=f(null),c=f(null),{currentOrganization:b}=da(),_=f([]),h=f(!1),w=B("modal"),k=B("modalTitle");function A(){b.value&&(h.value=!0,ke(b.value.id).then((()=>{n.replace("/"),window.location.reload()})).catch((()=>o.error(a("An error occured when deleting the organization.")))).finally((()=>h.value=!1)))}function x(e){h.value=!0,ze(e).then((()=>o.success(a("Organization updated !")))).catch((()=>o.error(a("An error occured when updating the organization.")))).finally((()=>h.value=!1))}return m((async()=>i.value=await Q())),(e,o)=>{const n=z("router-link");return l(),t("div",jt,[u(Te,null,{default:v((()=>[s("li",null,[u(n,{class:"fr-breadcrumb__link",to:"/"},{default:v((()=>[y(d(r(a)("Administration")),1)])),_:1})]),r(b)?(l(),t("li",Ht,[u(n,{class:"fr-breadcrumb__link",to:"/"},{default:v((()=>[y(d(r(b).name),1)])),_:1})])):g("",!0),s("li",null,[s("a",Nt,d(r(a)("Profile")),1)])])),_:1}),c.value?(l(),t("h2",{key:0,class:"subtitle subtitle--uppercase fr-mb-5v",id:c.value.legend},d(r(a)("Edit profile")),9,Yt)):g("",!0),r(b)?(l(),p(we,{key:1,organization:r(b),errors:_.value,showLegend:!1,showWell:!1,ref_key:"form",ref:c,onSubmit:x},{submitButton:v((({submit:e})=>[s("button",{class:"fr-btn fr-btn--icon-left fr-icon-save-line",disabled:h.value,"data-testid":"submitButton",onClick:e},d(r(a)("Save")),9,Wt)])),default:v((()=>[u(Bl,{class:"fr-mt-6w"},{default:v((()=>[s("div",Gt,[s("p",Jt,d(r(a)("Delete the organization")),1),s("p",Zt,d(r(a)("Be careful, this action can't be reverse.")),1)]),s("div",Kt,[s("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error fr-btn--icon-left fr-icon-delete-line",disabled:h.value,"data-fr-opened":"false","aria-controls":r(w)},d(r(a)("Delete")),9,Qt),(l(),p(C,{to:"body"},[s("dialog",{"aria-labelledby":r(k),role:"dialog",id:r(w),class:"fr-modal"},[s("div",er,[s("div",ar,[s("div",lr,[s("div",tr,[s("div",rr,[s("button",{class:"fr-btn--close fr-btn",title:r(a)("Close the modal dialog"),"aria-controls":r(w)},d(r(a)("Close")),9,sr)]),s("div",or,[s("h1",{id:r(k),class:"fr-modal__title fr-mb-2w"},d(r(a)("Are you sure you want to delete this organization ?")),9,nr),s("p",ir,d(r(a)("This action can't be reverse.")),1),s("p",null,d(r(a)("All content published with this organization will stay online, with the same URL but in an anonymous form, i.e. without being linked to a data producer.")),1),s("p",null,d(r(a)("If you want to delete your published content too, start by deleting the contents before deleting your account.")),1)]),s("div",dr,[s("div",ur,[s("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error",role:"button",disabled:h.value,onClick:A},d(r(a)("Delete")),9,cr)])])])])])])],8,Xt)]))])])),_:1})])),_:1},8,["organization","errors"])):g("",!0)])}}});Ae({admin_root:I,default_lang:Ce.global.locale.value,only_locales:Ce.global.locale.value,schema_documentation_url:xe,schema_validata_url:qe,show_copy_resource_permalink:!0,tabular_api_url:Se,tabular_page_size:$e,title:H});const mr=[{path:"/me",component:Na,name:"me"},{path:"/organizations/:oid",children:[{path:"datasets",component:Aa,props:!0,name:"organization-datasets"},{path:"reuses",component:Va,props:!0,name:"organization-reuses"},{path:"members",component:Lt,props:!0,name:"organization-members"},{path:"profile",component:fr,props:!0,name:"organization-profile"}]}],br=Pe({history:Be(),routes:mr}),pr=q(ml);Me(pr),pr.use(De),pr.use(Fe),pr.use(Ce),pr.use(br),pr.mount("#admin"),globalThis.dsfr.start(),console.log("JS is injected !")}}}));
