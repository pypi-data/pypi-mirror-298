import{openBlock as u,createElementBlock as g,unref as t,createElementVNode as e,renderSlot as I,defineComponent as M,Fragment as D,toDisplayString as o,createVNode as l,normalizeClass as W,ref as w,onMounted as G,mergeProps as de,createBlock as A,withCtx as f,createCommentVNode as S,computed as F,createTextVNode as $,renderList as Y,readonly as ye,watchEffect as se,resolveComponent as V,watchPostEffect as $e,Teleport as X,withModifiers as K,createApp as we}from"vue";import{y as R,C as U,bj as ke,G as L,_ as H,b as ze,d as Ae,bk as Ce,af as x,z as ue,I as Q,D as Se,F as O,b3 as oe,bl as Me,bm as qe,ao as ce,b7 as Re,bn as Te,bo as De,ak as Pe,J as fe,ab as Be,bp as Oe,aL as ae,X as re,a$ as Ie,bq as Fe,br as me,U as E,a5 as Ue,aI as _e,bs as Le,ap as Ve,W as ee,$ as Ee,bt as He,bu as je,aD as Ne,bv as We,bw as ne,bx as Ye,by as Ge,bz as Je,bA as Ze,bB as Ke,bC as Qe,b2 as Xe,bD as xe,bE as et,b9 as tt,bc as te,aK as st,bd as ot,be as at,bf as rt,bF as nt,bG as lt,bg as it,bh as dt,bi as ut}from"./sentry.5.2.3.dev30935.js";import"vue-content-loader";import"./_commonjsHelpers.5.2.3.dev30935.js";function Ha(){import.meta.url,import("_").catch(()=>1);async function*v(){}}const ct=["aria-label"],ft={class:"fr-breadcrumb__list"},J={__name:"Breadcrumb",setup(v){const{t:s}=R();return(a,_)=>(u(),g("nav",{rol:"navigation","aria-label":t(s)("You're here:"),class:"fr-breadcrumb fr-mb-5v"},[e("ol",ft,[I(a.$slots,"default")])],8,ct))}},mt={class:"fr-text--sm fr-my-0"},_t={class:"fr-grid-row fr-grid-row--right not-enlarged"},pt=["href","title"],bt=M({__name:"QualityScoreTooltipContent",props:{dataset:{}},setup(v){const{t:s}=R();return(a,_)=>(u(),g(D,null,[e("h5",mt,o(t(s)("Metadata quality:")),1),l(t(U),{passed:a.dataset.quality.dataset_description_quality,messagePassed:t(s)("Data description filled"),messageFailed:t(s)("Data description empty"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),l(t(U),{passed:a.dataset.quality.resources_documentation,messagePassed:t(s)("Files documented"),messageFailed:t(s)("Files documentation missing"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),l(t(U),{passed:a.dataset.quality.license,messagePassed:t(s)("License filled"),messageFailed:t(s)("No license set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),l(t(U),{passed:a.dataset.quality.update_frequency&&!!a.dataset.quality.update_fulfilled_in_time,messagePassed:t(s)("Update frequency followed"),messageFailed:a.dataset.quality.update_frequency?t(s)("Update frequency not followed"):t(s)("Update frequency not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),l(t(U),{passed:a.dataset.quality.has_open_format,messagePassed:t(s)("File formats are open"),messageFailed:t(s)("File formats are closed"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),l(t(U),{passed:a.dataset.quality.temporal_coverage,messagePassed:t(s)("Temporal coverage filled"),messageFailed:t(s)("Temporal coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),l(t(U),{passed:a.dataset.quality.spatial,messagePassed:t(s)("Spatial coverage filled"),messageFailed:t(s)("Spatial coverage not set"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),l(t(U),{passed:a.dataset.quality.all_resources_available,messagePassed:t(s)("All files are available"),messageFailed:t(s)("Some files are unavailable"),class:"fr-my-1w"},null,8,["passed","messagePassed","messageFailed"]),e("div",_t,[e("a",{href:t(ke),target:"_blank",rel:"noopener",title:t(s)("Learn more about this indicator - opens a new window")},o(t(s)("Learn more about this indicator")),9,pt)])],64))}}),pe=M({__name:"AdminBadge",props:{type:{}},setup(v){return(s,a)=>(u(),g("p",{class:W(["fr-badge",{"fr-badge--blue-cumulus":s.type==="info","fr-badge--error fr-badge--no-icon":s.type==="error","fr-badge--warning fr-badge--no-icon":s.type==="warning","fr-badge--success fr-badge--no-icon":s.type==="success"}])},[I(s.$slots,"default")],2))}}),gt=["aria-describedby"],ht=["id"],vt=M({inheritAttrs:!1,__name:"AdminContentWithTooltip",setup(v){const s=L(),a=w(),_=w("");return G(()=>{a.value&&(_.value=a.value.textContent||"")}),(r,n)=>(u(),g(D,null,[e("p",de(r.$attrs,{"aria-describedby":t(s),ref_key:"contentRef",ref:a}),[I(r.$slots,"default",{},void 0,!0)],16,gt),e("span",{class:"fr-hidden-xl fr-tooltip fr-placement",id:t(s),role:"tooltip","aria-hidden":"true"},o(_.value),9,ht)],64))}});const be=H(vt,[["__scopeId","data-v-d192f17a"]]),yt=M({__name:"AdminLoader",props:{scale:{default:4}},setup(v){return ze(Ce),(s,a)=>(u(),A(t(Ae),{name:"ri-loader-5-line",animation:"spin",scale:s.scale,fill:"var(--blue-cumulus-sun-368-moon-732)"},null,8,["scale"]))}}),$t={class:"fr-table fr-mb-2w"},wt=M({__name:"AdminTable",props:{loading:{type:Boolean,default:!1}},setup(v){return(s,a)=>(u(),g("div",$t,[e("table",null,[I(s.$slots,"default",{},void 0,!0)]),s.loading?(u(),A(x,{key:0,class:"fr-p-4w text-align-center"},{default:f(()=>[l(yt)]),_:1})):S("",!0)]))}});const ge=H(wt,[["__scopeId","data-v-cae574a4"]]),kt={class:"fr-text--bold"},zt={key:1,class:"fr-grid-row fr-grid-row--middle justify-between"},At=["title"],Ct=M({__name:"AdminTableTh",props:{sorted:{}},emits:["sort"],setup(v,{emit:s}){const a=v,_=s,{t:r}=R(),n=F(()=>a.sorted!==void 0);function i(){return a.sorted==="desc"?_("sort","asc"):_("sort","desc")}return(c,p)=>(u(),g("th",kt,[n.value?(u(),g("div",zt,[I(c.$slots,"default",{},void 0,!0),e("button",{class:W(["fr-ml-1w fr-btn fr-btn--sm fr-btn--tertiary-no-outline",{"fr-icon-arrow-down-line":!c.sorted||c.sorted==="asc","fr-icon-arrow-up-line":c.sorted==="desc","text-grey-500":c.sorted,"text-mention-grey":!c.sorted}]),onClick:i,title:t(r)("Sort")},o(t(r)("Sort")),11,At)])):I(c.$slots,"default",{key:0},void 0,!0)]))}});const q=H(Ct,[["__scopeId","data-v-5acf0bf0"]]),St=["aria-describedby"],Mt=["id"],B=M({__name:"Tooltip",setup(v){const s=L("tooltip");return(a,_)=>(u(),g(D,null,[e("p",de(a.$attrs,{"aria-describedby":t(s)}),[I(a.$slots,"default")],16,St),e("span",{class:"fr-tooltip fr-placement",id:t(s),role:"tooltip","aria-hidden":"true"},[I(a.$slots,"tooltip")],8,Mt)],64))}}),qt=["href"],Rt={class:"monospace"},Tt={class:"monospace"},Dt={class:"monospace"},Pt={class:"monospace"},Bt={class:"monospace"},Ot=M({__name:"AdminDatasetsTable",props:{datasets:{},loading:{type:Boolean},sortDirection:{},sortedBy:{}},emits:["sort"],setup(v,{emit:s}){const a=s,_=v,{t:r}=R();function n(y,m){a("sort",y,m)}function i(y){return _.sortedBy===y?_.sortDirection:null}function c(y){return Array.isArray(y.resources)?y.resources.length:y.resources.total}function p(y){return"".concat(oe,"dataset/").concat(y.id,"/")}function k(y){return y.deleted?{label:r("Deleted"),type:"error"}:y.archived?{label:r("Archived"),type:"warning"}:y.private?{label:r("Private"),type:"default"}:{label:r("Public"),type:"info"}}return(y,m)=>(u(),A(ge,{loading:y.loading},{default:f(()=>[e("thead",null,[e("tr",null,[l(q,{onSort:m[0]||(m[0]=d=>n("title",d)),sorted:i("title"),scope:"col"},{default:f(()=>[$(o(t(r)("Title of the dataset")),1)]),_:1},8,["sorted"]),l(q,{scope:"col"},{default:f(()=>[$(o(t(r)("Status")),1)]),_:1}),l(q,{onSort:m[1]||(m[1]=d=>n("created",d)),sorted:i("created"),scope:"col"},{default:f(()=>[$(o(t(r)("Created at")),1)]),_:1},8,["sorted"]),l(q,{onSort:m[2]||(m[2]=d=>n("last_update",d)),sorted:i("last_update"),scope:"col"},{default:f(()=>[$(o(t(r)("Updated at")),1)]),_:1},8,["sorted"]),l(q,{scope:"col"},{default:f(()=>[$(o(t(r)("Files")),1)]),_:1}),l(q,{scope:"col"},{default:f(()=>[$(o(t(r)("Score")),1)]),_:1}),l(q,{scope:"col"},{default:f(()=>[l(B,null,{tooltip:f(()=>[$(o(t(r)("Discussions")),1)]),default:f(()=>[m[6]||(m[6]=e("span",{class:"fr-icon--sm fr-icon-chat-3-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1}),l(q,{onSort:m[3]||(m[3]=d=>n("views",d)),sorted:i("views"),scope:"col"},{default:f(()=>[l(B,null,{tooltip:f(()=>[$(o(t(r)("Views")),1)]),default:f(()=>[m[7]||(m[7]=e("span",{class:"fr-icon--sm fr-icon-eye-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1},8,["sorted"]),l(q,{scope:"col"},{default:f(()=>[l(B,null,{tooltip:f(()=>[$(o(t(r)("Downloads")),1)]),default:f(()=>[m[8]||(m[8]=e("span",{class:"fr-icon--sm fr-icon-download-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1}),l(q,{onSort:m[4]||(m[4]=d=>n("reuses",d)),sorted:i("reuses"),scope:"col"},{default:f(()=>[l(B,null,{tooltip:f(()=>[$(o(t(r)("Reuses")),1)]),default:f(()=>[m[9]||(m[9]=e("span",{class:"fr-icon--sm fr-icon-line-chart-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1},8,["sorted"]),l(q,{onSort:m[5]||(m[5]=d=>n("followers",d)),sorted:i("followers"),scope:"col"},{default:f(()=>[l(B,null,{tooltip:f(()=>[$(o(t(r)("Favorites")),1)]),default:f(()=>[m[10]||(m[10]=e("span",{class:"fr-icon--sm fr-icon-star-s-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1},8,["sorted"])])]),e("tbody",null,[(u(!0),g(D,null,Y(y.datasets,d=>{var b;return u(),g("tr",{key:d.id},[e("td",null,[l(be,null,{default:f(()=>[e("a",{class:"fr-link fr-reset-link",href:p(d)},[l(t(ue),{text:d.title,"auto-resize":!0,"max-lines":2},null,8,["text"])],8,qt)]),_:2},1024)]),e("td",null,[l(pe,{type:k(d).type},{default:f(()=>[$(o(k(d).label),1)]),_:2},1032,["type"])]),e("td",null,o(t(Q)(d.created_at)),1),e("td",null,o(t(Q)(d.last_modified)),1),e("td",null,o(c(d)),1),e("td",null,[l(B,null,{tooltip:f(()=>[l(bt,{dataset:d},null,8,["dataset"])]),default:f(()=>[l(t(Se),{class:"w-100",score:d.quality.score},null,8,["score"])]),_:2},1024)]),e("td",Rt,o(t(O)(d.metrics.discussions)),1),e("td",Tt,o(t(O)(d.metrics.views)),1),e("td",Dt,o(t(O)((b=d.metrics.resources_downloads)!=null?b:0)),1),e("td",Pt,o(t(O)(d.metrics.reuses)),1),e("td",Bt,o(t(O)(d.metrics.followers)),1)])}),128))])]),_:1},8,["loading"]))}}),le=w(null);function Z(){const v=s=>{le.value=s};return{currentOrganization:ye(le),setCurrentOrganization:v}}const It="/_themes/gouvfr/assets/logotype-white.svg",Ft=["href"],Ut=["src","alt"],he=M({__name:"AdminPublishButton",props:{type:{}},setup(v){const s=v,{t:a}=R(),_=F(()=>{switch(s.type){case"dataset":return qe;case"reuse":return Me}});return(r,n)=>(u(),g("a",{href:_.value,class:"fr-btn fr-icon-add-line fr-btn--icon-left"},[$(o(t(a)("Publish on"))+" ",1),e("img",{class:"fr-ml-1v",src:t(It),loading:"lazy",alt:t(ce)},null,8,Ut)],8,Ft))}}),Lt={key:0},Vt={class:"fr-breadcrumb__link","aria-current":"page"},Et={class:"fr-h3 fr-mb-5v"},Ht={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},jt={class:"fr-col"},Nt={class:"subtitle subtitle--uppercase fr-m-0"},Wt={key:0,class:"fr-col-auto fr-grid-row fr-grid-row--middle"},Yt=["href"],Gt={class:"text-align-center fr-py-1w"},Jt=["src"],Zt={class:"fr-text--bold fr-my-3v"},Kt=M({__name:"Datasets",props:{oid:{}},setup(v){const{t:s}=R(),a=v,_=w([]),r=w(!1),n=w(1),i=w(10),c=w(0),p=w("created"),k=w("asc"),y=F(()=>"".concat(k.value==="asc"?"":"-").concat(p.value)),m=w(""),d=Re(m,Be),{currentOrganization:b}=Z();function z(h,C){p.value=h,k.value=C}return se(async()=>{r.value=!0,_.value=[];try{const h=await Te(a.oid,d.value,n.value,i.value,y.value);_.value=h.data,n.value=h.page,i.value=h.page_size,c.value=h.total}finally{r.value=!1}}),(h,C)=>{const P=V("router-link");return u(),g("div",null,[l(J,null,{default:f(()=>[e("li",null,[l(P,{class:"fr-breadcrumb__link",to:"/"},{default:f(()=>[$(o(t(s)("Administration")),1)]),_:1})]),t(b)?(u(),g("li",Lt,[l(P,{class:"fr-breadcrumb__link",to:"/"},{default:f(()=>[$(o(t(b).name),1)]),_:1})])):S("",!0),e("li",null,[e("a",Vt,o(t(s)("Datasets")),1)])]),_:1}),e("h1",Et,o(t(s)("Datasets")),1),e("div",Ht,[e("div",jt,[e("h2",Nt,o(t(s)("{n} datasets",c.value)),1)]),c.value?(u(),g("div",Wt,[e("div",null,[e("a",{href:t(De)(h.oid),class:"fr-btn fr-btn--sm fr-icon-download-line fr-btn--icon-left"},o(t(s)("Download catalog")),9,Yt)])])):S("",!0)]),r.value||c.value>0?(u(),A(Ot,{key:0,datasets:_.value,loading:r.value,"sort-direction":k.value,sortedBy:p.value,onSort:z},null,8,["datasets","loading","sort-direction","sortedBy"])):(u(),A(x,{key:1,class:"fr-my-2w"},{default:f(()=>[e("div",Gt,[e("img",{src:t(Pe),alt:"",loading:"lazy"},null,8,Jt),e("p",Zt,o(t(s)("You haven't published a dataset yet")),1),l(he,{type:"dataset"})])]),_:1})),c.value>i.value?(u(),A(t(fe),{key:2,page:n.value,"page-size":i.value,"total-results":c.value,onChange:C[0]||(C[0]=T=>n.value=T)},null,8,["page","page-size","total-results"])):S("",!0)])}}}),Qt=["href"],Xt={class:"monospace"},xt={class:"monospace"},es={class:"monospace"},ts={class:"monospace"},ss=M({__name:"AdminReusesTable",props:{reuses:{},loading:{type:Boolean},sortedBy:{},sortDirection:{}},emits:["sort"],setup(v){const s=v,{t:a}=R();function _(i){return s.sortedBy===i?s.sortDirection:null}function r(i){return"".concat(oe,"reuse/").concat(i.id,"/")}function n(i){return i.deleted?{label:a("Deleted"),type:"error"}:i.archived?{label:a("Archived"),type:"warning"}:i.private?{label:a("Private"),type:"default"}:{label:a("Public"),type:"info"}}return(i,c)=>(u(),A(ge,{loading:i.loading},{default:f(()=>[e("thead",null,[l(q,{onSort:c[0]||(c[0]=p=>i.$emit("sort","title",p)),sorted:_("title"),scope:"col"},{default:f(()=>[$(o(t(a)("Reuse title")),1)]),_:1},8,["sorted"]),l(q,null,{default:f(()=>[$(o(t(a)("Status")),1)]),_:1}),l(q,{onSort:c[1]||(c[1]=p=>i.$emit("sort","created",p)),sorted:_("created"),scope:"col"},{default:f(()=>[$(o(t(a)("Created at")),1)]),_:1},8,["sorted"]),l(q,{onSort:c[2]||(c[2]=p=>i.$emit("sort","datasets",p)),sorted:_("datasets"),scope:"col"},{default:f(()=>[$(o(t(a)("Datasets")),1)]),_:1},8,["sorted"]),l(q,{scope:"col"},{default:f(()=>[l(B,null,{tooltip:f(()=>[$(o(t(a)("Discussions")),1)]),default:f(()=>[c[5]||(c[5]=e("span",{class:"fr-icon--sm fr-icon-chat-3-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1}),l(q,{onSort:c[3]||(c[3]=p=>i.$emit("sort","views",p)),sorted:_("views"),scope:"col"},{default:f(()=>[l(B,null,{tooltip:f(()=>[$(o(t(a)("Views")),1)]),default:f(()=>[c[6]||(c[6]=e("span",{class:"fr-icon--sm fr-icon-eye-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1},8,["sorted"]),l(q,{onSort:c[4]||(c[4]=p=>i.$emit("sort","followers",p)),sorted:_("followers"),scope:"col"},{default:f(()=>[l(B,null,{tooltip:f(()=>[$(o(t(a)("Favorites")),1)]),default:f(()=>[c[7]||(c[7]=e("span",{class:"fr-icon--sm fr-icon-star-s-line","aria-hidden":"true"},null,-1))]),_:1})]),_:1},8,["sorted"])]),e("tbody",null,[(u(!0),g(D,null,Y(i.reuses,p=>(u(),g("tr",null,[e("td",null,[l(be,null,{default:f(()=>[e("a",{class:"fr-link fr-reset-link",href:r(p)},[l(t(ue),{text:p.title,"auto-resize":!0,"max-lines":2},null,8,["text"])],8,Qt)]),_:2},1024)]),e("td",null,[l(pe,{type:n(p).type},{default:f(()=>[$(o(n(p).label),1)]),_:2},1032,["type"])]),e("td",null,o(t(Q)(p.created_at)),1),e("td",Xt,o(t(O)(p.datasets.length)),1),e("td",xt,o(t(O)(p.metrics.discussions)),1),e("td",es,o(t(O)(p.metrics.views)),1),e("td",ts,o(t(O)(p.metrics.followers)),1)]))),256))])]),_:1},8,["loading"]))}}),os="/_themes/gouvfr/assets/reuse.svg",as={class:"fr-container--fluid"},rs={key:0},ns={class:"fr-breadcrumb__link","aria-current":"page"},ls={class:"fr-h3"},is={class:"subtitle subtitle--uppercase"},ds={class:"text-align-center fr-py-1w"},us=["src"],cs={class:"fr-text--bold fr-my-3v"},fs=M({__name:"Reuses",props:{oid:{}},setup(v){const{t:s}=R(),a=v,_=w([]),r=w(!1),n=w(1),i=w(10),c=w(0),p=w("created"),k=w("asc"),y=F(()=>"".concat(k.value==="asc"?"":"-").concat(p.value)),{currentOrganization:m}=Z();function d(b,z){p.value=b,k.value=z}return se(async()=>{r.value=!0,_.value=[];try{const b=await Oe(a.oid,n.value,i.value,y.value);_.value=b.data,n.value=b.page,i.value=b.page_size,c.value=b.total}finally{r.value=!1}}),(b,z)=>{const h=V("router-link");return u(),g("div",as,[l(J,null,{default:f(()=>[e("li",null,[l(h,{class:"fr-breadcrumb__link",to:"/"},{default:f(()=>[$(o(t(s)("Administration")),1)]),_:1})]),t(m)?(u(),g("li",rs,[l(h,{class:"fr-breadcrumb__link",to:"/"},{default:f(()=>[$(o(t(m).name),1)]),_:1})])):S("",!0),e("li",null,[e("a",ns,o(t(s)("Reuses")),1)])]),_:1}),e("h1",ls,o(t(s)("Reuses")),1),e("h2",is,o(t(s)("{n} reuses of your organization",_.value.length)),1),r.value||c.value>0?(u(),A(ss,{key:0,reuses:_.value,loading:r.value,sortDirection:k.value,sortedBy:p.value,onSort:d},null,8,["reuses","loading","sortDirection","sortedBy"])):(u(),A(x,{key:1,class:"fr-mt-1w fr-mb-2w"},{default:f(()=>[e("div",ds,[e("img",{src:t(os),alt:"",loading:"lazy"},null,8,us),e("p",cs,o(t(s)("You haven't published a reuse yet")),1),l(he,{type:"reuse"})])]),_:1})),c.value>i.value?(u(),A(t(fe),{key:2,page:n.value,"page-size":i.value,"total-results":c.value,onChange:z[0]||(z[0]=C=>n.value=C)},null,8,["page","page-size","total-results"])):S("",!0)])}}}),ms={class:"fr-breadcrumb__link","aria-current":"page"},_s={key:0,class:"fr-h1"},ps={class:"fr-alert fr-alert--info"},bs={class:"fr-alert__title"},gs={href:"/admin/me/"},hs=M({__name:"Me",setup(v){const{t:s}=R(),a=w(null);return G(async()=>a.value=await ae()),(_,r)=>{const n=V("router-link");return u(),g("div",null,[l(J,null,{default:f(()=>[e("li",null,[l(n,{class:"fr-breadcrumb__link",to:"/"},{default:f(()=>[$(o(t(s)("Administration")),1)]),_:1})]),e("li",null,[e("a",ms,o(t(s)("Me")),1)])]),_:1}),a.value?(u(),g("h1",_s,o(a.value.first_name)+" "+o(a.value.last_name),1)):S("",!0),e("div",ps,[e("h3",bs,o(t(s)("This is a WIP page")),1),e("p",null,[e("a",gs,o(t(s)("You can edit your profil on the current admin.")),1)])])])}}}),vs='<svg width="24" height="24" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M5 12V18C5 18 5 21 12 21C19 21 19 18 19 18V12" stroke="currentColor" stroke-width="1.5"/>\n<path d="M5 6V12C5 12 5 15 12 15C19 15 19 12 19 12V6" stroke="currentColor" stroke-width="1.5"/>\n<path d="M12 3C19 3 19 6 19 6C19 6 19 9 12 9C5 9 5 6 5 6C5 6 5 3 12 3Z" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n',ys={class:"fr-sidemenu__item"},$s=["innerHTML"],ws=M({__name:"AdminSidebarLink",props:{label:{},icon:{},iconHtml:{},to:{}},setup(v){return(s,a)=>{const _=V("router-link");return u(),g("li",ys,[e("div",{class:W([{"fr-icon-svg fr-icon--sm":s.iconHtml},"fr-enlarge-link fr-sidemenu__link fr-mb-1w"])},[s.iconHtml?(u(),g("div",{key:0,class:"fr-mr-1w fr-grid-row",innerHTML:s.iconHtml},null,8,$s)):s.icon?(u(),g("div",{key:1,class:W([s.icon,"fr-mr-1w fr-icon--sm"]),"aria-hidden":"true"},null,2)):S("",!0),l(_,{to:s.to},{default:f(()=>[$(o(s.label),1)]),_:1},8,["to"])],2)])}}});const N=H(ws,[["__scopeId","data-v-5e2ff0a8"]]),ks=["aria-expanded","aria-controls","aria-current"],zs={class:"fr-mx-1w"},As={class:"logo logo--sm"},Cs={class:"fr-mx-1w fr-col text-overflow-ellipsis"},Ss=["id"],Ms={class:"fr-sidemenu__list fr-mx-1w fr-my-3v"},qs=M({__name:"AdminSidebarMenu",props:{user:{},organization:{},isOpened:{type:Boolean}},emits:["open","click"],setup(v){const s=v,{t:a}=R(),_=L("menu");function r(n,i){const c=document.getElementById(_);i(c)&&(n?i(c).collapse.disclose():i(c).collapse.conceal())}return $e(()=>{setTimeout(()=>{r(s.isOpened,globalThis.dsfr)},200)}),(n,i)=>(u(),g("li",{class:W(["fr-sidemenu__item",{"fr-sidemenu__item--active":n.isOpened}])},[e("button",{class:"fr-sidemenu__btn","aria-expanded":n.isOpened,"aria-controls":t(_),"aria-current":n.isOpened,onClick:i[0]||(i[0]=c=>n.$emit("open"))},[n.user?(u(),g(D,{key:0},[n.user?(u(),A(re,{key:0,user:n.user,size:24,rounded:!0},null,8,["user"])):S("",!0),e("p",zs,o(t(a)("My Profil")),1)],64)):n.organization?(u(),g(D,{key:1},[e("div",As,[l(Ie,{type:"organization",src:n.organization.logo_thumbnail,size:20},null,8,["src"])]),e("p",Cs,o(n.organization.name),1)],64)):S("",!0)],8,ks),e("div",{class:"fr-collapse","data-fr-js-collapse":"",id:t(_)},[e("ul",Ms,[n.user?(u(),A(N,{key:0,icon:"fr-icon-account-circle-line",label:t(a)("Me"),to:"/me"},null,8,["label"])):n.organization?(u(),g(D,{key:1},[l(N,{iconHtml:t(vs),label:t(a)("Datasets"),to:{name:"organization-datasets",params:{oid:n.organization.id}},onClick:i[1]||(i[1]=c=>n.$emit("click"))},null,8,["iconHtml","label","to"]),l(N,{icon:"fr-icon-line-chart-line",label:t(a)("Reuses"),to:{name:"organization-reuses",params:{oid:n.organization.id}},onClick:i[2]||(i[2]=c=>n.$emit("click"))},null,8,["label","to"]),l(N,{icon:"fr-icon-parent-line",label:t(a)("Members"),to:{name:"organization-members",params:{oid:n.organization.id}}},null,8,["label","to"]),l(N,{icon:"fr-icon-user-line",label:t(a)("Profile"),to:{name:"organization-profile",params:{oid:n.organization.id}}},null,8,["label","to"])],64)):S("",!0)])],8,Ss)],2))}});const ie=H(qs,[["__scopeId","data-v-352caa70"]]),Rs={class:"fr-container--fluid h-100"},Ts={class:"fr-grid-row h-100 bg-grey-50"},Ds={class:"fr-col-12 fr-col-md-4 fr-col-lg-3 fr-col-xl-2"},Ps=["aria-label"],Bs={class:"fr-sidemenu__inner"},Os=["aria-controls"],Is=["id"],Fs={class:"fr-sidemenu__list"},Us={class:"fr-col-12 fr-col-md-8 fr-col-lg-9 fr-col-xl-10 h-100 fr-px-2w"},Ls=M({__name:"Admin",setup(v){const{t:s}=R(),a=Fe(),_=L("menu"),r=w(null),n=w(),{setCurrentOrganization:i}=Z(),c=me();function p(y){return y===n.value}function k(y){n.value=y.id}return G(async()=>{var y,m;if(r.value=await ae(),a.name||(r.value.organizations.length>0?c.replace({name:"organization-datasets",params:{oid:r.value.organizations[0].id}}):c.replace({name:"me"})),a.name==="me")n.value=(y=E)==null?void 0:y.id;else if(r.value.organizations.length>0){let d=r.value.organizations[0];a.params.oid&&(d=(m=r.value.organizations.find(b=>b.id===a.params.oid))!=null?m:d),k(d),i(d)}}),(y,m)=>{const d=V("router-view");return u(),g("div",Rs,[e("div",Ts,[e("div",Ds,[e("nav",{class:"fr-sidemenu fr-pr-0","aria-label":t(s)("Administration menu")},[e("div",Bs,[e("button",{class:"fr-sidemenu__btn",hidden:"","aria-controls":t(_),"aria-expanded":"false"},o(t(s)("Open menu")),9,Os),e("div",{class:"fr-collapse",id:t(_)},[e("ul",Fs,[t(E)?(u(),A(ie,{key:0,user:t(E),"is-opened":p(t(E).id),onOpen:m[0]||(m[0]=b=>k(t(E)))},null,8,["user","is-opened"])):S("",!0),r.value?(u(!0),g(D,{key:1},Y(r.value.organizations,b=>(u(),A(ie,{organization:b,"is-opened":p(b.id),onOpen:()=>k(b),onClick:()=>t(i)(b)},null,8,["organization","is-opened","onOpen","onClick"]))),256)):S("",!0)])],8,Is)])],8,Ps)]),e("div",Us,[(u(),A(d,{key:t(a).fullPath,class:"fr-container--fluid"}))])])])}}});const Vs=H(Ls,[["__scopeId","data-v-1057ebbe"]]),Es=["aria-labelledby","id"],Hs={class:"fr-container fr-container--fluid fr-container-md"},js={class:"fr-grid-row fr-grid-row--center"},Ns={class:"fr-col-12 fr-col-md-8"},Ws={class:"fr-modal__body"},Ys={class:"fr-modal__header"},Gs=["title","aria-controls"],Js={class:"fr-modal__content"},Zs=["id"],Ks={class:"fr-modal__footer"},Qs={class:"fr-btns-group fr-btns-group--right fr-btns-group--sm fr-btns-group--inline-lg fr-btns-group--icon-left"},Xs=["disabled"],xs=["disabled"],eo=M({__name:"AdminAddMemberModal",props:{id:{},oid:{},roles:{}},emits:["memberAdded"],setup(v,{emit:s}){const a=v,_=s,{t:r}=R(),{toast:n}=ee(),i=w(!1),c=w(),p=w("editor"),k=F(()=>"fr-modal-title-user-"+a.id);async function y(){try{i.value=!0,c.value&&(await Le(a.oid,c.value,p.value),_("memberAdded"),d())}catch(b){n.error(r("An error occurred while update member role."))}finally{i.value=!1}}function m(b){return b.map(z=>{var C;const h={...z,avatar_thumbnail:(C=z.avatar_url)!=null?C:void 0};return{value:h.id,label:h.first_name+" "+h.last_name,image:Ve(h,32)}})}function d(){i.value=!1,c.value=void 0,p.value="editor";const b=document.getElementById(a.id);globalThis.dsfr(b).modal.conceal()}return(b,z)=>(u(),A(X,{to:"body"},[e("dialog",{"aria-labelledby":k.value,role:"dialog",id:b.id,class:"fr-modal"},[e("div",Hs,[e("div",js,[e("div",Ns,[e("div",Ws,[e("div",Ys,[e("button",{class:"fr-btn--close fr-btn",title:t(r)("Close the modal dialog"),"aria-controls":b.id},o(t(r)("Close")),9,Gs)]),e("form",{onSubmit:K(y,["prevent"])},[e("div",Js,[e("h1",{id:k.value,class:"fr-modal__title fr-mb-2w"},o(t(r)("Add member to the organization")),9,Zs),l(Ue,{placeholder:b.$t("Search a user"),searchPlaceholder:b.$t("Search a user..."),suggestUrl:"/users/suggest/",values:c.value,onChange:z[0]||(z[0]=h=>c.value=h),allOption:b.$t("Select a user"),addAllOption:!1,onSuggest:m,roundedImages:!0},null,8,["placeholder","searchPlaceholder","values","allOption"]),b.roles.length>0?(u(),A(_e,{key:0,label:t(r)("Role of the member"),"model-value":p.value,"onUpdate:modelValue":z[1]||(z[1]=h=>p.value=h),options:b.roles},null,8,["label","model-value","options"])):S("",!0)]),e("div",Ks,[e("div",Qs,[e("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",type:"button",onClick:d,disabled:i.value},o(t(r)("Cancel")),9,Xs),e("button",{class:"fr-btn",type:"submit",disabled:i.value},o(t(r)("Add to the organization")),9,xs)])])],32)])])])])],8,Es)]))}}),to=["aria-controls"],so=M({__name:"AdminAddMemberButton",props:{oid:{},roles:{}},emits:["memberAdded"],setup(v){const s=v,{t:a}=R(),_=F(()=>"fr-modal-add-user-"+s.oid);return(r,n)=>(u(),g(D,null,[e("button",{class:"fr-btn fr-btn--sm fr-btn--icon-left fr-icon-add-line","data-fr-opened":"false","aria-controls":_.value},o(t(a)("Add member")),9,to),l(eo,{id:_.value,oid:r.oid,roles:r.roles,onMemberAdded:n[0]||(n[0]=i=>r.$emit("memberAdded"))},null,8,["id","oid","roles"])],64))}}),oo={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},ve=M({__name:"AdminDangerZone",setup(v){return(s,a)=>(u(),A(t(Ee),{color:"error",type:"secondary",weight:"regular"},{default:f(()=>[e("div",oo,[I(s.$slots,"default")])]),_:3}))}}),ao=["aria-labelledby","id"],ro={class:"fr-container fr-container--fluid fr-container-md"},no={class:"fr-grid-row fr-grid-row--center"},lo={class:"fr-col-12 fr-col-md-8"},io={class:"fr-modal__body"},uo={class:"fr-modal__header"},co=["title","aria-controls"],fo={class:"fr-modal__content"},mo=["id"],_o={class:"fr-grid-row fr-grid-row--middle fr-text--bold fr-mb-2w"},po={class:"fr-col"},bo={class:"fr-col-auto"},go=["disabled"],ho={class:"fr-col"},vo={class:"fr-m-0 text-grey-500"},yo={class:"fr-m-0 fr-text--xs text-default-error"},$o={class:"fr-col-auto"},wo=["disabled"],ko=M({__name:"AdminEditMemberModal",props:{id:{},member:{},oid:{},roles:{}},emits:["memberUpdated"],setup(v,{emit:s}){const a=v,_=s,r=F(()=>"fr-modal-title-user-"+a.id),{t:n}=R(),{toast:i}=ee(),c=w(!1);async function p(d){if(!d.newRole){m();return}try{c.value=!0,await He(a.oid,d.user.id,d.newRole),_("memberUpdated"),m()}catch(b){i.error(n("An error occurred while update member role."))}finally{c.value=!1}}async function k(d){try{c.value=!0,await je(a.oid,d.user.id),_("memberUpdated")}catch(b){i.error(n("An error occurred while removing this member."))}finally{c.value=!1}}function y(d){return a.roles.map(b=>{const z={...b};return z.value===d&&(z.selected=!0),z})}function m(){c.value=!1;const d=document.getElementById(a.id);globalThis.dsfr(d).modal.conceal()}return(d,b)=>(u(),A(X,{to:"body"},[e("dialog",{"aria-labelledby":r.value,role:"dialog",id:d.id,class:"fr-modal"},[e("div",ro,[e("div",no,[e("div",lo,[e("div",io,[e("div",uo,[e("button",{class:"fr-btn--close fr-btn",title:t(n)("Close the modal dialog"),"aria-controls":d.id},o(t(n)("Close")),9,co)]),e("div",fo,[e("h1",{id:r.value,class:"fr-modal__title fr-mb-2w"},o(t(n)("Edit member")),9,mo),e("p",_o,[l(re,{class:"fr-mr-1v",user:d.member.user,rounded:!0,size:24},null,8,["user"]),$(" "+o(d.member.user.first_name)+" "+o(d.member.user.last_name),1)]),e("form",{class:"fr-grid-row fr-grid-row--gutters fr-grid-row--bottom",onSubmit:b[1]||(b[1]=K(z=>p(d.member),["prevent"]))},[e("div",po,[d.roles.length>0?(u(),A(_e,{key:0,label:t(n)("Role of the member"),"model-value":d.member.role,"onUpdate:modelValue":b[0]||(b[0]=z=>d.member.newRole=z),options:y(d.member.role)},null,8,["label","model-value","options"])):S("",!0)]),e("div",bo,[e("button",{class:"fr-btn",type:"submit",disabled:c.value},o(t(n)("Validate")),9,go)])],32),l(ve,{class:"fr-mt-2w"},{default:f(()=>[e("div",ho,[e("p",vo,o(t(n)("Remove member from the organization")),1),e("p",yo,o(t(n)("Be careful, this action can't be reverse.")),1)]),e("div",$o,[e("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error fr-btn--icon-left fr-icon-logout-box-r-line",disabled:c.value,onClick:b[2]||(b[2]=z=>k(d.member))},o(t(n)("Remove member")),9,wo)])]),_:1})])])])])])],8,ao)]))}}),zo=["aria-controls"],Ao=M({__name:"AdminEditMemberButton",props:{member:{},oid:{},roles:{}},emits:["memberUpdated"],setup(v){const s=v,{t:a}=R(),_=F(()=>"fr-modal-user-"+s.member.user.id);return(r,n)=>(u(),g(D,null,[e("button",{class:"fr-btn fr-btn--sm fr-btn--tertiary-no-outline fr-icon-pencil-line","data-fr-opened":"false","aria-controls":_.value},o(t(a)("Edit")),9,zo),l(ko,{id:_.value,member:r.member,oid:r.oid,roles:r.roles,onMemberUpdated:n[0]||(n[0]=i=>r.$emit("memberUpdated"))},null,8,["id","member","oid","roles"])],64))}}),Co={class:"fr-mt-n9v fr-mb-2w"},So={class:"fr-badge fr-badge--info fr-badge--no-icon"},Mo={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle"},qo={class:"fr-col"},Ro={class:"fr-grid-row fr-grid-row--middle"},To={class:"fr-ml-3v fr-mt-1-5v fr-mb-0 filet filet-default-grey fr-text--sm"},Do={key:0,class:"fr-col-auto fr-grid-row flex-direction-column"},Po=["disabled"],Bo=["disabled","aria-controls"],Oo=["aria-labelledby","id"],Io={class:"fr-container fr-container--fluid fr-container-md"},Fo={class:"fr-grid-row fr-grid-row--center"},Uo={class:"fr-col-12 fr-col-md-8"},Lo={class:"fr-modal__body"},Vo={class:"fr-modal__header"},Eo=["title","aria-controls"],Ho={class:"fr-modal__content"},jo=["id"],No={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--right"},Wo={class:"fr-col-auto"},Yo=["disabled"],Go={class:"fr-col-auto"},Jo=["disabled"],Zo=M({__name:"AdminMembershipRequest",props:{loading:{type:Boolean},oid:{},request:{},showActions:{type:Boolean}},emits:["accept","refuse"],setup(v,{emit:s}){const a=v,_=s,{t:r}=R(),n=w(""),i=L("modal"),c=L("modalTitle");function p(){const m=document.getElementById(i);globalThis.dsfr(m).modal.conceal()}function k(){_("refuse",a.request.id,n.value),p()}function y(){n.value="",p()}return(m,d)=>{const b=V("AdminMembershipRequest",!0);return u(),A(x,{class:"drop-shadow rounded-xxs fr-mt-3w"},{default:f(()=>[e("div",Co,[e("p",So,[d[2]||(d[2]=e("span",{class:"fr-icon-user-add-line fr-icon--sm","aria-hidden":"true"},null,-1)),$(" "+o(t(r)("Membership Request")),1)])]),e("div",Mo,[e("div",qo,[e("div",Ro,[l(re,{class:"fr-mr-1v",user:m.request.user,rounded:!0,size:24},null,8,["user"]),$(" "+o(t(r)("{fullName} asks to join the organization.",{fullName:m.request.user.first_name+" "+m.request.user.last_name})),1)]),e("div",To,o(m.request.comment),1)]),m.showActions?(u(),g("div",Do,[e("button",{class:"fr-btn fr-btn--sm fr-btn--icon-left fr-mb-1w fr-icon-check-line",onClick:d[0]||(d[0]=z=>m.$emit("accept",m.request.id)),disabled:m.loading,"data-testid":"accept"},o(t(r)("Accept request")),9,Po),e("button",{class:"fr-btn fr-btn--icon-left fr-btn--sm fr-btn--secondary fr-btn--secondary--error fr-icon-close-line",disabled:m.loading,"data-fr-opened":"false","aria-controls":t(i),"data-testid":"refuse"},o(t(r)("Refuse")),9,Bo),(u(),A(X,{to:"body"},[e("dialog",{"aria-labelledby":t(c),role:"dialog",id:t(i),class:"fr-modal","data-testid":"modal"},[e("div",Io,[e("div",Fo,[e("div",Uo,[e("div",Lo,[e("div",Vo,[e("button",{class:"fr-btn--close fr-btn",title:t(r)("Close the modal dialog"),"aria-controls":t(i),onClick:K(y,["prevent"])},o(t(r)("Close")),9,Eo)]),e("div",Ho,[e("h1",{id:t(c),class:"fr-modal__title fr-mb-2w"},o(t(r)("Refuse membership request")),9,jo),l(b,{class:"fr-mt-4w fr-mb-2w",loading:!1,oid:m.oid,request:m.request,"show-actions":!1},null,8,["oid","request"]),e("form",{onSubmit:K(k,["prevent"]),onReset:y},[l(Ne,{label:t(r)("You can provide the refusal reason:"),modelValue:n.value,"onUpdate:modelValue":d[1]||(d[1]=z=>n.value=z),"data-testid":"comment-group"},null,8,["label","modelValue"]),e("div",No,[e("div",Wo,[e("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary-grey-500",type:"reset",disabled:m.loading,"data-testid":"cancel-modal-button"},o(t(r)("Cancel")),9,Yo)]),e("div",Go,[e("button",{class:"fr-btn",type:"submit",disabled:m.loading,"data-testid":"refuse-modal-button"},o(t(r)("Refuse request")),9,Jo)])])],32)])])])])])],8,Oo)]))])):S("",!0)])]),_:1})}}}),Ko={key:0},Qo={class:"fr-breadcrumb__link","aria-current":"page"},Xo={class:"fr-grid-row fr-grid-row--gutters fr-grid-row--middle justify-center"},xo={class:"fr-col-12 fr-col-md"},ea={class:"fr-h1 fr-mb-2w"},ta={key:0,class:"fr-col-auto"},sa={class:"subtitle subtitle--uppercase"},oa={class:"subtitle subtitle--uppercase fr-mt-2w fr-mb-1v"},aa={class:"fr-table fr-table--layout-fixed"},ra={scope:"col"},na={scope:"col"},la={scope:"col"},ia={scope:"col"},da={scope:"col"},ua={key:0,scope:"col"},ca={class:"fr-badge"},fa={key:0},ma={key:1},_a={key:0},pa=M({__name:"Members",props:{oid:{}},setup(v){const s=v,{t:a}=R(),{toast:_}=ee(),r=w([]),n=F(()=>We||p.value.some(h=>{var C;return h.user.id===((C=E)==null?void 0:C.id)&&h.role==="admin"})),i=w([]),{currentOrganization:c}=Z(),p=w([]),k=w(!1);function y(h){var C,P;return(P=(C=i.value.find(T=>T.value===h))==null?void 0:C.label)!=null?P:h}async function m(){const h=await Ze(s.oid);p.value=h.members}async function d(){const h=await ne(s.oid);r.value=h}async function b(h){k.value=!0;const C=[];try{await Ke(s.oid,h),C.push(d()),C.push(m())}catch(P){_.error(a("An error occurred while accepting this membership."))}finally{Promise.all(C).finally(()=>k.value=!1)}}async function z(h,C){k.value=!0;const P=[];try{await Qe(s.oid,h,C),P.push(d()),P.push(m())}catch(T){_.error(a("An error occurred while refusing this membership."))}finally{Promise.all(P).finally(()=>k.value=!1)}}return se(()=>{n.value&&ne(s.oid).then(h=>r.value=h)}),G(()=>{Ye().then(Ge).then(h=>i.value=h),m()}),(h,C)=>{const P=V("router-link");return u(),g("div",null,[l(J,null,{default:f(()=>[e("li",null,[l(P,{class:"fr-breadcrumb__link",to:"/"},{default:f(()=>[$(o(t(a)("Administration")),1)]),_:1})]),t(c)?(u(),g("li",Ko,[l(P,{class:"fr-breadcrumb__link",to:"/"},{default:f(()=>[$(o(t(c).name),1)]),_:1})])):S("",!0),e("li",null,[e("a",Qo,o(t(a)("Members")),1)])]),_:1}),e("div",Xo,[e("div",xo,[e("h1",ea,o(t(a)("Members")),1)]),n.value?(u(),g("div",ta,[l(so,{oid:h.oid,roles:i.value,onMemberAdded:m},null,8,["oid","roles"])])):S("",!0)]),r.value.length?(u(),g(D,{key:0},[e("h2",sa,o(t(a)("{n} requests",{n:r.value.length})),1),(u(!0),g(D,null,Y(r.value,T=>(u(),A(Zo,{class:"fr-mb-4w",key:T.id,loading:k.value,oid:h.oid,request:T,"show-actions":!0,onAccept:b,onRefuse:z},null,8,["loading","oid","request"]))),128))],64)):S("",!0),e("h2",oa,o(t(a)("{n} members",{n:p.value.length})),1),e("div",aa,[e("table",null,[e("thead",null,[e("tr",null,[e("th",ra,o(t(a)("Members")),1),e("th",na,o(t(a)("Email")),1),e("th",la,o(t(a)("Status")),1),e("th",ia,o(t(a)("Member since")),1),e("th",da,o(t(a)("Last connection")),1),n.value?(u(),g("th",ua,o(t(a)("Action")),1)):S("",!0)])]),e("tbody",null,[(u(!0),g(D,null,Y(p.value,T=>(u(),g("tr",{key:T.user.id},[e("td",null,o(T.user.first_name)+" "+o(T.user.last_name),1),e("td",null,o(T.user.email),1),e("td",null,[e("p",ca,o(y(T.role)),1)]),e("td",null,o(t(Q)(T.since)),1),e("td",null,[T.user.last_login_at?(u(),g("span",fa,o(t(Je)(T.user.last_login_at)),1)):(u(),g("span",ma,o(t(a)("No connection")),1))]),n.value?(u(),g("td",_a,[l(Ao,{member:T,oid:h.oid,roles:i.value,onMemberUpdated:m},null,8,["member","oid","roles"])])):S("",!0)]))),128))])])])])}}}),ba={class:"fr-container--fluid"},ga={key:0},ha={class:"fr-breadcrumb__link","aria-current":"page"},va=["id"],ya=["disabled","onClick"],$a={class:"fr-col"},wa={class:"fr-m-0 text-grey-500"},ka={class:"fr-m-0 fr-text--xs text-default-error"},za={class:"fr-col-auto"},Aa=["disabled","aria-controls"],Ca=["aria-labelledby","id"],Sa={class:"fr-container fr-container--fluid fr-container-md"},Ma={class:"fr-grid-row fr-grid-row--center"},qa={class:"fr-col-12 fr-col-md-8"},Ra={class:"fr-modal__body"},Ta={class:"fr-modal__header"},Da=["title","aria-controls"],Pa={class:"fr-modal__content"},Ba=["id"],Oa={class:"fr-text--bold"},Ia={class:"fr-modal__footer"},Fa={class:"fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left"},Ua=["disabled"],La=M({__name:"Profile",props:{oid:{}},setup(v){const{t:s}=R(),{toast:a}=ee(),_=me(),r=w(null),n=w(null),{currentOrganization:i}=Z(),c=w([]),p=w(!1),k=L("modal"),y=L("modalTitle");function m(){i.value&&(p.value=!0,xe(i.value.id).then(()=>{_.replace("/"),window.location.reload()}).catch(()=>a.error(s("An error occured when deleting the organization."))).finally(()=>p.value=!1))}function d(b){p.value=!0,et(b).then(()=>a.success(s("Organization updated !"))).catch(()=>a.error(s("An error occured when updating the organization."))).finally(()=>p.value=!1)}return G(async()=>r.value=await ae()),(b,z)=>{const h=V("router-link");return u(),g("div",ba,[l(J,null,{default:f(()=>[e("li",null,[l(h,{class:"fr-breadcrumb__link",to:"/"},{default:f(()=>[$(o(t(s)("Administration")),1)]),_:1})]),t(i)?(u(),g("li",ga,[l(h,{class:"fr-breadcrumb__link",to:"/"},{default:f(()=>[$(o(t(i).name),1)]),_:1})])):S("",!0),e("li",null,[e("a",ha,o(t(s)("Profile")),1)])]),_:1}),n.value?(u(),g("h2",{key:0,class:"subtitle subtitle--uppercase fr-mb-5v",id:n.value.legend},o(t(s)("Edit profile")),9,va)):S("",!0),t(i)?(u(),A(Xe,{key:1,organization:t(i),errors:c.value,showLegend:!1,showWell:!1,ref_key:"form",ref:n,onSubmit:d},{submitButton:f(({submit:C})=>[e("button",{class:"fr-btn fr-btn--icon-left fr-icon-save-line",disabled:p.value,"data-testid":"submitButton",onClick:C},o(t(s)("Save")),9,ya)]),default:f(()=>[l(ve,{class:"fr-mt-6w"},{default:f(()=>[e("div",$a,[e("p",wa,o(t(s)("Delete the organization")),1),e("p",ka,o(t(s)("Be careful, this action can't be reverse.")),1)]),e("div",za,[e("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error fr-btn--icon-left fr-icon-delete-line",disabled:p.value,"data-fr-opened":"false","aria-controls":t(k)},o(t(s)("Delete")),9,Aa),(u(),A(X,{to:"body"},[e("dialog",{"aria-labelledby":t(y),role:"dialog",id:t(k),class:"fr-modal"},[e("div",Sa,[e("div",Ma,[e("div",qa,[e("div",Ra,[e("div",Ta,[e("button",{class:"fr-btn--close fr-btn",title:t(s)("Close the modal dialog"),"aria-controls":t(k)},o(t(s)("Close")),9,Da)]),e("div",Pa,[e("h1",{id:t(y),class:"fr-modal__title fr-mb-2w"},o(t(s)("Are you sure you want to delete this organization ?")),9,Ba),e("p",Oa,o(t(s)("This action can't be reverse.")),1),e("p",null,o(t(s)("All content published with this organization will stay online, with the same URL but in an anonymous form, i.e. without being linked to a data producer.")),1),e("p",null,o(t(s)("If you want to delete your published content too, start by deleting the contents before deleting your account.")),1)]),e("div",Ia,[e("div",Fa,[e("button",{class:"fr-btn fr-btn--secondary fr-btn--secondary--error",role:"button",disabled:p.value,onClick:m},o(t(s)("Delete")),9,Ua)])])])])])])],8,Ca)]))])]),_:1})]),_:1},8,["organization","errors"])):S("",!0)])}}});tt({admin_root:oe,default_lang:te.global.locale.value,only_locales:te.global.locale.value,schema_documentation_url:st,schema_validata_url:ot,show_copy_resource_permalink:!0,tabular_api_url:at,tabular_page_size:rt,title:ce});const Va=[{path:"/me",component:hs,name:"me"},{path:"/organizations/:oid",children:[{path:"datasets",component:Kt,props:!0,name:"organization-datasets"},{path:"reuses",component:fs,props:!0,name:"organization-reuses"},{path:"members",component:pa,props:!0,name:"organization-members"},{path:"profile",component:La,props:!0,name:"organization-profile"}]}],Ea=nt({history:lt(),routes:Va}),j=we(Vs);it(j);j.use(dt);j.use(ut);j.use(te);j.use(Ea);j.mount("#admin");globalThis.dsfr.start();console.log("JS is injected !");export{Ha as __vite_legacy_guard};
