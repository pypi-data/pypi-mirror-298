"use strict";(self.webpackChunk_jupyterlab_latex=self.webpackChunk_jupyterlab_latex||[]).push([[876],{876:(e,t,n)=>{n.r(t),n.d(t,{IPDFJSTracker:()=>G,default:()=>ce});var r=n(909),a=n(200),o=n(473),i=n(456),s=n(710),c=n(354),l=n(614),d=n(818),h=n(262),p=n(12),u=n(256),v=n(345),g=n(628);class m extends u.Widget{constructor(){super(),this.addClass("jp-LatexErrorPanel")}set text(e){g.render(v.createElement(w,{text:e}),this.node,(()=>{this.update()}))}onUpdateRequest(e){const t=this.node.children[0];t.scrollTop=t.scrollHeight}onCloseRequest(e){this.dispose()}}class w extends v.Component{render(){return v.createElement("pre",{className:"jp-LatexErrorContainer"},v.createElement("code",null,this.props.text))}}var f=n(209),x=n(602),b=n(135),y=n(72),P=n.n(y),C=n(825),j=n.n(C),E=n(659),S=n.n(E),L=n(56),_=n.n(L),D=n(540),I=n.n(D),M=n(113),F=n.n(M),T=n(646),k={};k.styleTagTransform=F(),k.setAttributes=_(),k.insert=S().bind(null,"head"),k.domAPI=j(),k.insertStyleElement=I(),P()(T.A,k),T.A&&T.A.locals&&T.A.locals;var R=n(460);const B=new R.LabIcon({name:"latex:download",svgstr:'<svg height="24" viewBox="0 0 451.111 451.111" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path class="jp-icon3 jp-icon-selectable" fill="#616161" d="m225.556 354.445 145-145-48.333-48.333-64.444 64.444v-225.556h-64.444v225.556l-64.444-64.444-48.333 48.333z"/>\n    <path class="jp-icon3 jp-icon-selectable" fill="#616161" d="m0 386.667h451.111v64.444h-451.111z"/>\n</svg>\n'}),N=new R.LabIcon({name:"latex:fit",svgstr:'<svg class="jp-icon3" fill="#616161" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <defs>\n        <path d="M0 0h24v24H0z" id="a"/>\n    </defs>\n    <clipPath id="b">\n        <use overflow="visible" xlink:href="#a"/>\n    </clipPath>\n    <path clip-path="url(#b)" d="M15 3l2.3 2.3-2.89 2.87 1.42 1.42L18.7 6.7 21 9V3zM3 9l2.3-2.3 2.87 2.89 1.42-1.42L6.7 5.3 9 3H3zm6 12l-2.3-2.3 2.89-2.87-1.42-1.42L5.3 17.3 3 15v6zm12-6l-2.3 2.3-2.87-2.89-1.42 1.42 2.89 2.87L15 21h6z"/>\n    <path clip-path="url(#b)" d="M0 0h24v24H0z" fill="none"/>\n</svg>'}),z=new R.LabIcon({name:"latex:next",svgstr:'<svg height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path class="jp-icon3" fill="#616161" d="M7.41 7.84L12 12.42l4.59-4.58L18 9.25l-6 6-6-6z"/>\n    <path d="M0-.75h24v24H0z" fill="none"/>\n</svg>'}),V=new R.LabIcon({name:"latex:previous",svgstr:'<svg height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path class="jp-icon3" fill="#616161" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/>\n    <path d="M0 0h24v24H0z" fill="none"/>\n</svg>'}),U=new R.LabIcon({name:"latex:zoom-in",svgstr:'<svg height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path class="jp-icon3" fill="#616161" d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>\n    <path fill="none" d="M0 0h24v24H0V0z" />\n    <path class="jp-icon3" fill="#616161" d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"/>\n</svg>'}),A=new R.LabIcon({name:"latex:zoom-out",svgstr:'<svg height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M0 0h24v24H0V0z" fill="none"/>\n    <path class="jp-icon3" fill="#616161" d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z"/>\n</svg>'});class W extends v.Component{constructor(){super(...arguments),this.state={currentPageNumber:0,pagesCount:0,userInput:null},this.handleChange=e=>{const t=e.target.value;this.setState({userInput:t})},this.handleFocus=e=>{e.target.select()},this.handleBlur=e=>{const{value:t}=e.target;this.setCurrentPage(t)},this.handleKeyDown=e=>{if("Enter"===e.key){const{value:t}=e.target;this.setCurrentPage(t)}},this.handlePageDataChange=()=>{const{widget:e}=this.props;if(!e.viewer)return;const{currentPageLabel:t,currentPageNumber:n,pagesCount:r}=e.viewer;this.setState({currentPageLabel:t,currentPageNumber:n,pagesCount:r,userInput:null})}}componentDidMount(){this.props.widget.ready.then((()=>{const{eventBus:e}=this.props.widget.viewer;e.on("firstpage",this.handlePageDataChange),e.on("pagechanging",this.handlePageDataChange),e.on("pagelabels",this.handlePageDataChange),this.handlePageDataChange()}))}componentWillUnmount(){this.props.widget.ready.then((()=>{const{eventBus:e}=this.props.widget.viewer;e.off("firstpage",this.handlePageDataChange),e.off("pagechanging",this.handlePageDataChange),e.off("pagelabels",this.handlePageDataChange)}))}setCurrentPage(e){const{widget:t}=this.props;t.viewer&&(t.viewer.currentPageLabel=e,this.setState({userInput:null}))}render(){const{currentPageLabel:e,currentPageNumber:t,pagesCount:n,userInput:r}=this.state,a=e?` (${t} of ${n})`:` of ${n}`,o=null!==r?r:e||t.toString();return v.createElement("div",{className:"jp-PDFJSPageNumber"},v.createElement("span",null,v.createElement("input",{value:o,onBlur:this.handleBlur,onChange:this.handleChange,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown}),v.createElement("span",null,a)))}}class H extends a.ReactWidget{constructor(e){super(),this._props=e}render(){return v.createElement(W,{...this._props})}}const J=!!navigator.platform.match(/Mac/i);class q extends u.Widget{constructor(e){super({node:K.createNode()}),this._ready=new h.PromiseDelegate,this._objectUrl="",this._positionRequested=new x.Signal(this),this._hasRendered=!1,this._pdfjsLoaded=K.ensurePDFJS().then((e=>{const t=new e.EventBus;this._getDocument=e.getDocument,this._viewer=new e.PDFViewer({container:this.node,eventBus:t})})),this.context=e,this._onTitleChanged(),e.pathChanged.connect(this._onTitleChanged,this),e.ready.then((()=>{this.isDisposed||(this._render().then((()=>{this._ready.resolve(void 0)})),e.model.contentChanged.connect(this.update,this),e.fileChanged.connect(this.update,this))}))}get viewer(){return this._viewer}get ready(){return this._ready.promise}get position(){return{page:this.viewer?this.viewer.currentPageNumber:0,x:0,y:0}}set position(e){if(!this._viewer)return;const t=Math.max(Math.min(e.page,this._viewer.pagesCount+1),1),n=this._viewer.getPageView(t-1).viewport.viewBox[3],r=Math.max(Math.min(n-(e.y-72),n),0);this._viewer.scrollPageIntoView({pageNumber:t,destArray:[t,{name:"XYZ"},e.x,r,this._viewer.currentScaleValue]})}dispose(){try{URL.revokeObjectURL(this._objectUrl)}catch(e){}super.dispose()}get positionRequested(){return this._positionRequested}_onTitleChanged(){this.title.label=o.PathExt.basename(this.context.localPath)}async _render(){return await this._pdfjsLoaded,new Promise((e=>{if(!this._viewer)return;const t=this.context.model.toString();t||e(void 0);const n=K.b64toBlob(t,"application/pdf"),r=this._pdfDocument,a=this._objectUrl;this._objectUrl=URL.createObjectURL(n);let o="page-width",i=0;this._hasRendered&&this.isVisible&&(o=this._viewer.currentScale||o,i=this.node.scrollTop);const s=()=>{if(r&&r.destroy(),a)try{URL.revokeObjectURL(a)}catch(e){}};this._getDocument(this._objectUrl).promise.then((t=>{this._pdfDocument=t,this._viewer.setDocument(t),t.getPageLabels().then((e=>{if(!e)return;let t=0;const n=e.length;if(n===this._viewer.pagesCount){for(;t<n&&e[t]===(t+1).toString();)t++;t!==n&&(this._viewer.setPageLabels(e),this._viewer.eventBus.dispatch("pagelabels"))}else console.error("The number of Page Labels does not match the number of pages in the document.")})),this._viewer.firstPagePromise.then((()=>{this.isVisible&&(this._viewer.currentScaleValue=o),this._hasRendered=!0,this._viewer.eventBus.dispatch("firstpage"),e(void 0)})),this._viewer.pagesPromise.then((()=>{this.isVisible&&(this.node.scrollTop=i),s()}))})).catch(s)}))}handleEvent(e){this.viewer&&"click"===e.type&&this._handleClick(e)}_handleClick(e){if(!(e=>!!e.shiftKey&&(J&&e.metaKey||!J&&e.ctrlKey))(e))return;const t=this._clientToPDFPosition(e.clientX,e.clientY);t&&this._positionRequested.emit(t)}_clientToPDFPosition(e,t){if(!this._viewer)return;let n,r=0;for(;r<this._viewer.pagesCount;r++){const a=this._viewer.getPageView(r);if(!a.textLayer)continue;const o=a.textLayer.textLayerDiv;if(f.ElementExt.hitTest(o,e,t)){n=a;break}}if(!n)return;const a=n.textLayer.textLayerDiv.getBoundingClientRect(),o=e-a.left,i=t-a.top,s=n.viewport.clone({dontFlip:!0}),[c,l]=s.convertToPdfPoint(o,i);return{page:r+1,x:c,y:l}}onAfterAttach(e){super.onAfterAttach(e),this.node.addEventListener("click",this)}onBeforeDetach(e){this.node.removeEventListener("click",this)}fit(){this._viewer&&this.isVisible&&(this._viewer.currentScaleValue="page-width")}onUpdateRequest(e){!this.isDisposed&&this.context.isReady&&this._render()}}class X extends b.DocumentWidget{constructor(e){const t=new q(e),n=K.createToolbar(t);super({content:t,context:e,reveal:t.ready,toolbar:n})}}class O extends b.ABCWidgetFactory{createNewWidget(e){return new X(e)}}var K;!function(e){e.createNode=function(){const e=document.createElement("div");e.className="jp-PDFJSContainer";const t=document.createElement("div");return t.className="pdfViewer",e.appendChild(t),e.tabIndex=-1,e},e.createToolbar=function(e){const t=new a.Toolbar;return t.addClass("jp-Toolbar"),t.addClass("jp-PDFJS-toolbar"),t.addItem("previous",new a.ToolbarButton({icon:V,onClick:()=>{e.viewer&&(e.viewer.currentPageNumber=Math.max(e.viewer.currentPageNumber-1,1))},tooltip:"Previous Page"})),t.addItem("next",new a.ToolbarButton({icon:z,onClick:()=>{e.viewer&&(e.viewer.currentPageNumber=Math.min(e.viewer.currentPageNumber+1,e.viewer.pagesCount))},tooltip:"Next Page"})),t.addItem("PageNumber",new H({widget:e})),t.addItem("spacer",a.Toolbar.createSpacerItem()),t.addItem("zoomOut",new a.ToolbarButton({icon:A,onClick:()=>{if(!e.viewer)return;let t=e.viewer.currentScale;t=(t/1.1).toFixed(2),t=Math.floor(10*t)/10,t=Math.max(.25,t),e.viewer.currentScale=t},tooltip:"Zoom Out"})),t.addItem("zoomIn",new a.ToolbarButton({icon:U,onClick:()=>{if(!e.viewer)return;let t=e.viewer.currentScale;t=(1.1*t).toFixed(2),t=Math.ceil(10*t)/10,t=Math.min(10,t),e.viewer.currentScale=t},tooltip:"Zoom In"})),t.addItem("fit",new a.ToolbarButton({icon:N,onClick:()=>{e.viewer&&(e.viewer.currentScaleValue="page-width")},tooltip:"Fit to Page Width"})),t.addItem("download",new a.ToolbarButton({icon:B,onClick:()=>{e.viewer&&e.context.download()},tooltip:"Download"})),t},e.b64toBlob=function(e,t="",n=512){const r=atob(e),a=[];for(let e=0;e<r.length;e+=n){const t=r.slice(e,e+n),o=new Array(t.length);for(let e=0;e<t.length;e++)o[e]=t.charCodeAt(e);const i=new Uint8Array(o);a.push(i)}return new Blob(a,{type:t})},e.ensurePDFJS=async function(){let e,t;try{e=await Promise.all([n.e(630),n.e(84)]).then(n.t.bind(n,630,23)),await n.e(920).then(n.t.bind(n,920,23)),t=await Promise.all([n.e(743),n.e(703)]).then(n.t.bind(n,743,23)),await n.e(973).then(n.bind(n,973))}catch(e){console.error(e)}return{...(({getDocument:e})=>({getDocument:e}))(e),...(({PDFViewer:e,EventBus:t})=>({PDFViewer:e,EventBus:t}))(t)}}}(K||(K={}));var $=n(887),Y=n(313),Z=n(241);const G=new h.Token("@jupyterlab/latex:IPDFJSTracker"),Q="@jupyterlab/latex:plugin";var ee;!function(e){e.openLatexPreview="latex:open-preview",e.synctexEdit="latex:synctex-edit",e.synctexView="latex:synctex-view",e.createNew="latex:create-new-latex-file"}(ee||(ee={}));const te={id:Q,requires:[Y.IDefaultFileBrowser,i.IDocumentManager,s.IEditorTracker,r.ILabShell,r.ILayoutRestorer,G,l.ISettingRegistry,d.IStateDB],optional:[$.ILauncher,Z.IMainMenu,a.ICommandPalette],activate:function(e,t,n,r,i,s,l,d,h,u,v,g){const{commands:m}=e,w="jupyterlab-latex",f=new R.LabIcon({name:"launcher:latex-icon",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="2500" height="2500" viewBox="0 0 192.756 192.756"><g fill-rule="evenodd" clip-rule="evenodd"><path fill="#fff" d="M0 0h192.756v192.756H0V0z"/><path d="M50.618 101.811l1.231.268-4.314 13.678H8.504v-1.371h1.903c2.132 0 3.654-.697 4.568-2.08.521-.799.774-2.641.774-5.508V74.263c0-3.146-.343-5.113-1.041-5.9-.964-1.091-2.398-1.637-4.301-1.637H8.504v-1.383h22.827v1.383c-2.677-.025-4.555.216-5.634.736-1.078.52-1.814 1.18-2.208 1.979-.393.786-.596 2.689-.596 5.685v31.67c0 2.057.203 3.465.596 4.238.292.521.749.9 1.371 1.154.621.242 2.55.369 5.798.369h3.68c3.87 0 6.585-.279 8.146-.852 1.561-.57 2.982-1.586 4.276-3.031 1.282-1.445 2.576-3.742 3.858-6.863z"/><path d="M56.631 92.346H41.439l-2.657 6.193c-.662 1.521-.987 2.658-.987 3.418 0 .594.286 1.117.849 1.57.573.455 1.797.752 3.694.889v1.068H29.98v-1.068c1.64-.295 2.697-.67 3.181-1.135.988-.92 2.075-2.805 3.27-5.641L50.24 65.349h1.008l13.661 32.637c1.097 2.627 2.094 4.326 2.993 5.107.899.779 2.153 1.225 3.753 1.322v1.068H56.167v-1.068c1.561-.078 2.618-.346 3.171-.789.553-.436.83-.979.83-1.621 0-.848-.396-2.182-1.166-4.02l-2.371-5.639zm-.81-2.144l-6.658-15.854-6.826 15.854h13.484z"/><path d="M104.479 65.008l.562 11.921h-1.432c-.27-2.098-.641-3.594-1.127-4.502-.768-1.445-1.803-2.507-3.082-3.198-1.291-.69-2.98-1.036-5.077-1.036H87.16v38.833c0 3.121.345 5.064 1.011 5.846.946 1.049 2.417 1.572 4.387 1.572h1.766v1.381H72.771v-1.381h1.804c2.148 0 3.671-.652 4.566-1.957.55-.793.832-2.621.832-5.461V68.193h-6.114c-2.366 0-4.055.179-5.052.524-1.304.474-2.417 1.395-3.338 2.737-.921 1.355-1.471 3.172-1.649 5.475H62.4l.601-11.921h41.478z"/><path d="M110.646 81.675v19.258h10.709c2.785 0 4.637-.418 5.568-1.252 1.252-1.104 1.939-3.041 2.086-5.826h1.324v16.965h-1.324c-.332-2.367-.674-3.889-1.006-4.564-.43-.832-1.141-1.496-2.121-1.975-.982-.477-2.49-.723-4.527-.723h-10.709v16.068c0 2.158.1 3.473.283 3.938.195.467.527.834 1.006 1.117.479.27 1.398.404 2.734.404h8.268c2.748 0 4.76-.184 6-.576 1.25-.381 2.439-1.129 3.594-2.258 1.484-1.484 3.004-3.729 4.562-6.723h1.436l-4.195 12.219h-37.56v-1.324h1.73a6.837 6.837 0 0 0 3.262-.834c.773-.381 1.289-.957 1.57-1.719.27-.771.404-2.342.404-4.709v-31.66c0-3.091-.305-4.992-.932-5.716-.859-.957-2.293-1.436-4.305-1.436h-1.73v-1.337h37.56l.539 10.672h-1.41c-.504-2.563-1.055-4.318-1.668-5.274-.613-.957-1.51-1.693-2.711-2.196-.957-.355-2.65-.539-5.066-.539h-13.371z"/><path d="M161.217 87.709l10.832 16.14c2.996 4.469 5.219 7.289 6.68 8.471 1.447 1.18 3.289 1.828 5.523 1.955v1.371h-21.65v-1.371c1.434-.025 2.502-.178 3.199-.457a3.051 3.051 0 0 0 1.283-1.016c.33-.457.494-.928.494-1.398a4.8 4.8 0 0 0-.33-1.713c-.178-.42-.863-1.512-2.043-3.275l-8.561-12.941-10.564 13.537c-1.117 1.447-1.791 2.4-2.006 2.883-.229.482-.344.99-.344 1.51 0 .801.344 1.449 1.004 1.969.672.521 1.955.826 3.834.902v1.371h-17.893v-1.371c1.271-.127 2.35-.395 3.277-.787a18.931 18.931 0 0 0 4.381-2.604c1.396-1.092 2.984-2.77 4.762-5.029l11.912-15.022-9.932-14.553c-2.705-3.937-5.002-6.527-6.883-7.746-1.891-1.232-4.062-1.879-6.514-1.956v-1.384h23.328v1.384c-1.982.077-3.34.394-4.076.965-.725.571-1.092 1.207-1.092 1.892 0 .927.596 2.26 1.777 4.025l7.746 11.569 8.965-11.353c1.041-1.333 1.676-2.248 1.918-2.743.229-.508.355-1.016.355-1.537s-.152-.978-.457-1.372a2.9 2.9 0 0 0-1.41-1.092c-.572-.216-1.752-.33-3.529-.356v-1.384h17.891v1.384c-1.408.077-2.564.292-3.465.661-1.334.571-2.566 1.346-3.684 2.311s-2.691 2.756-4.725 5.359l-10.003 12.801z"/></g></svg>'});let x=!0;const b=c.ServerConnection.makeSettings(),y=t=>{const r=n.contextForWidget(t);if(!r)return;if(le.previews.has(r.path))return void r.save();const s=o.PathExt.dirname(r.path),l=o.PathExt.basename(r.path,".tex"),d=o.PathExt.join(s,l+".pdf");let p,u=null,v=!1;const g=()=>{let e=n.findWidget(d);e||(e=n.openOrReveal(d,"PDFJS",void 0,{mode:"split-right"})),e&&(e.content.positionRequested.connect(m),p=n.contextForWidget(e),p.disposed.connect(y))},m=(e,n)=>{ne(e.context.path,{...n,x:0},b).then((e=>{const n={line:e.line-1,column:0};t.content.editor.setCursorPosition(n)}))},f=()=>v?Promise.resolve(void 0):(v=!0,function(e,t,n){let r=o.URLExt.join(n.baseUrl,"latex","build",e);return r+="?synctex="+(t?1:0),c.ServerConnection.makeRequest(r,{},n).then((e=>200!==e.status?e.text().then((t=>{throw new c.ServerConnection.ResponseError(e,t)})):e.text()))}(e.serviceManager.contents.localPath(r.path),x,b).then((()=>{p?p.revert():g(),u&&u.close(),v=!1})).catch((e=>{u||(e=>{if(404!==e.response.status)u=le.createErrorPanel(),u.disposed.connect((()=>{u=null})),i.add(u,"main",{ref:t.id,mode:"split-bottom"}),u.text=e.message;else{const e={message:'You probably do not have jupyterlab_latex installed or enabled. Please, run "pip install -U jupyterlab_latex." If that does not work, try "jupyter serverextension enable --sys-prefix jupyterlab_latex".'};(0,a.showErrorMessage)("Server Extension Error",e)}})(e),v=!1})));r.fileChanged.connect(f),f().then((()=>{u||g()}));const y=()=>{r&&(le.previews.delete(r.path),u&&u.close(),r.fileChanged.disconnect(f),h.save(w,{paths:Array.from(le.previews)}))};r.disposed.connect(y),le.previews.add(r.path),h.save(w,{paths:Array.from(le.previews)})};Promise.all([h.fetch(w),e.restored]).then((([e])=>{(e&&e.paths||[]).forEach((e=>{const t=n.findWidget(e);t&&y(t)}))})),Promise.all([d.load(Q),e.restored]).then((([t])=>{let n=new p.DisposableSet;const a=t=>{const a=t.get("synctex").composite;x=!0!==a&&!1!==a||a,n.dispose(),x&&(n=function(e,t,n,r){const a=new p.DisposableSet;return a.add(e.commands.addCommand(ee.synctexEdit,{execute:()=>{const e=n.currentWidget;if(e){const n=e.content.position;return ne(e.context.path,n,r).then((n=>{if(!e)return;const r=o.PathExt.basename(e.context.path,".pdf"),a=o.PathExt.dirname(e.context.path),i=o.PathExt.join(a,r+".tex"),s=t.find((e=>e.context.path===i));s&&s.content.editor.setCursorPosition(n)}))}},isEnabled:()=>!!n.currentWidget,isVisible:()=>{const e=n.currentWidget;if(!e)return!1;const t=o.PathExt.basename(e.context.path,".pdf"),r=o.PathExt.dirname(e.context.path),a=o.PathExt.join(r,t+".tex");return le.previews.has(a)},label:"Scroll Editor to Page"})),a.add(e.commands.addCommand(ee.synctexView,{execute:()=>{const e=t.currentWidget;if(e){let t=e.content.editor.getCursorPosition();return t={line:t.line+1,column:t.column+1},function(e,t,n){let r=o.URLExt.join(n.baseUrl,"latex","synctex",e);return r+=`?line=${t.line}&column=${t.column}`,c.ServerConnection.makeRequest(r,{},n).then((e=>200!==e.status?e.text().then((t=>{throw new c.ServerConnection.ResponseError(e,t)})):e.json().then((e=>({page:parseInt(e.page,10),x:parseFloat(e.x),y:parseFloat(e.y)})))))}(e.context.path,t,r).then((t=>{if(!e)return;const r=o.PathExt.basename(e.context.path,".tex"),a=o.PathExt.dirname(e.context.path),i=o.PathExt.join(a,r+".pdf"),s=n.find((e=>e.context.path===i));s&&(s.content.position={...t,x:0})}))}},isEnabled:()=>!!t.currentWidget,isVisible:()=>{const e=t.currentWidget;return!!e&&le.previews.has(e.context.path)},label:"Scroll PDF to Cursor"})),a.add(e.contextMenu.addItem({command:ee.synctexView,selector:".jp-FileEditor"})),a.add(e.contextMenu.addItem({command:ee.synctexEdit,selector:".jp-PDFJSContainer"})),a.add(e.commands.addKeyBinding({selector:".jp-FileEditor",keys:["Accel Shift X"],command:ee.synctexView})),a.add(e.commands.addKeyBinding({selector:".jp-PDFJSContainer",keys:["Accel Shift X"],command:ee.synctexEdit})),a}(e,r,l,b))};t.changed.connect(a),a(t)})).catch((e=>{console.error(e.message)})),m.addCommand(ee.openLatexPreview,{execute:()=>{const e=r.currentWidget;e&&y(e)},isEnabled:()=>!!r.currentWidget,isVisible:()=>{const e=r.currentWidget;return e&&".tex"===o.PathExt.extname(e.context.path)||!1},label:"Show LaTeX Preview"});const P=ee.createNew,C=ee.openLatexPreview;m.addCommand(P,{label:e=>e.isPalette?"New LaTeX File":"LaTeX File",caption:"Create a new LaTeX file",icon:e=>e.isPalette?void 0:f,execute:async e=>{const n=e.cwd||t.model.path,r=await m.execute("docmanager:new-untitled",{path:n,type:"file",ext:"tex"});return m.execute("docmanager:open",{path:r.path,factory:oe})}}),e.contextMenu.addItem({command:C,selector:".jp-FileEditor"}),u&&u.add({command:P,category:ie,rank:1}),g&&g.addItem({command:P,args:{isPalette:!0},category:se}),v&&v.fileMenu.newMenu.addGroup([{command:P}],30)},autoStart:!0};function ne(e,t,n){let r=o.URLExt.join(n.baseUrl,"latex","synctex",e);return r+=`?page=${t.page}&x=${t.x}&y=${t.y}`,c.ServerConnection.makeRequest(r,{},n).then((e=>200!==e.status?e.text().then((t=>{throw new c.ServerConnection.ResponseError(e,t)})):e.json().then((e=>({line:parseInt(e.line,10),column:parseInt(e.column,10)})))))}const re=["PDF"],ae="PDFJS",oe="Editor",ie="Other",se="LaTeX Editor",ce=[te,{activate:function(e,t){const n=new O({name:ae,modelName:"base64",fileTypes:re,readOnly:!0}),r=new a.WidgetTracker({namespace:"pdfjs-widget"});return t.restore(r,{command:"docmanager:open",args:e=>({path:e.context.path,factory:ae}),name:e=>e.context.path}),e.docRegistry.addWidgetFactory(n),n.widgetCreated.connect(((t,n)=>{n.context.pathChanged.connect((()=>{r.save(n)})),r.add(n);const a=e.docRegistry.getFileTypesForPath(n.context.path);a.length>0&&(n.title.iconClass=a[0].iconClass||"",n.title.iconLabel=a[0].iconLabel||"")})),r},id:"@jupyterlab/pdfjs-extension:plugin",requires:[r.ILayoutRestorer],provides:G,autoStart:!0}];var le;!function(e){let t=0;e.previews=new Set,e.createErrorPanel=function(){const e=new m;return e.id="latex-error-"+ ++t,e.title.label="LaTeX Error",e.title.closable=!0,e}}(le||(le={}))},646:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(601),a=n.n(r),o=n(314),i=n.n(o)()(a());i.push([e.id,"/* -----------------------------------------------------------------------------\n| Copyright (c) Jupyter Development Team.\n| Distributed under the terms of the Modified BSD License.\n|---------------------------------------------------------------------------- */\n\n/* -----------------------------------------------------------------------------\n| Variables\n|---------------------------------------------------------------------------- */\n\n:root {\n  --jp-private-pdfjs-toolbar-height: 28px;\n}\n\n/* -----------------------------------------------------------------------------\n\n/*-----------------------------------------------------------------------------\n| Styles\n|---------------------------------------------------------------------------- */\n\n.jp-LatexErrorPanel {\n  min-height: 120px;\n  min-width: 120px;\n  color: var(--jp-error-color1);\n}\n\n.jp-LatexErrorContainer {\n  height: 100%;\n  overflow-y: auto;\n  margin: 1em;\n  white-space: pre-wrap;\n}\n\n.jp-PDFJSContainer {\n  background-color: #808080;\n  overflow: auto;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n}\n\n.jp-PDFJSPageNumber {\n  display: flex;\n  align-items: center;\n  padding: 0 6px;\n}\n\n.jp-PDFJSPageNumber input {\n  border: 1px solid var(--jp-border-color0);\n  background-color: var(--jp-input-background);\n  color: var(--jp-ui-font-color0);\n  padding: 0 6px;\n  text-align: right;\n  width: 8ch;\n}\n\n.jp-PDFJSPageNumber input:hover {\n  background-color: var(--jp-input-hover-background);\n}\n\n.jp-PDFJSPageNumber input:focus {\n  background-color: var(--jp-input-active-background);\n  border: 1px solid var(--jp-input-active-border-color);\n  box-shadow: var(--jp-input-box-shadow);\n}\n",""]);const s=i},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,a,o){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(i[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);r&&i[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),a&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=a):d[4]="".concat(a)),t.push(d))}},t}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var o={},i=[],s=0;s<e.length;s++){var c=e[s],l=r.base?c[0]+r.base:c[0],d=o[l]||0,h="".concat(l," ").concat(d);o[l]=d+1;var p=n(h),u={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)t[p].references++,t[p].updater(u);else{var v=a(u,r);r.byIndex=s,t.splice(s,0,{identifier:h,updater:v,references:1})}i.push(h)}return i}function a(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,a){var o=r(e=e||[],a=a||{});return function(e){e=e||[];for(var i=0;i<o.length;i++){var s=n(o[i]);t[s].references--}for(var c=r(e,a),l=0;l<o.length;l++){var d=n(o[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}o=c}}},659:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,a&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}}]);