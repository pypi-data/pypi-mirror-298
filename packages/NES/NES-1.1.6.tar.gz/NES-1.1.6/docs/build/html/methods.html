<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Methods &mdash; NES 1.1.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=cb7bf70b"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Formats" href="formats.html" />
    <link rel="prev" title="The NES object" href="object.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            NES
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="object.html">The NES object</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-nes.methods.cell_measures">Generic methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.cell_measures.calculate_cell_area"><code class="docutils literal notranslate"><span class="pre">calculate_cell_area()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.cell_measures.calculate_geometry_area"><code class="docutils literal notranslate"><span class="pre">calculate_geometry_area()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.cell_measures.calculate_grid_area"><code class="docutils literal notranslate"><span class="pre">calculate_grid_area()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.cell_measures.cross_product"><code class="docutils literal notranslate"><span class="pre">cross_product()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.cell_measures.lon_lat_to_cartesian"><code class="docutils literal notranslate"><span class="pre">lon_lat_to_cartesian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.cell_measures.mod_huiliers_area"><code class="docutils literal notranslate"><span class="pre">mod_huiliers_area()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.cell_measures.norm"><code class="docutils literal notranslate"><span class="pre">norm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.cell_measures.tri_area"><code class="docutils literal notranslate"><span class="pre">tri_area()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nes.methods.horizontal_interpolation">Horizontal interpolation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.horizontal_interpolation.create_area_conservative_weight_matrix"><code class="docutils literal notranslate"><span class="pre">create_area_conservative_weight_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.horizontal_interpolation.create_nn_weight_matrix"><code class="docutils literal notranslate"><span class="pre">create_nn_weight_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.horizontal_interpolation.get_src_data"><code class="docutils literal notranslate"><span class="pre">get_src_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.horizontal_interpolation.get_weights_idx_t_axis"><code class="docutils literal notranslate"><span class="pre">get_weights_idx_t_axis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.horizontal_interpolation.get_weights_idx_xy_axis"><code class="docutils literal notranslate"><span class="pre">get_weights_idx_xy_axis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.horizontal_interpolation.interpolate_horizontal"><code class="docutils literal notranslate"><span class="pre">interpolate_horizontal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.horizontal_interpolation.lon_lat_to_cartesian"><code class="docutils literal notranslate"><span class="pre">lon_lat_to_cartesian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.horizontal_interpolation.lon_lat_to_cartesian_ecef"><code class="docutils literal notranslate"><span class="pre">lon_lat_to_cartesian_ecef()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.horizontal_interpolation.read_weight_matrix"><code class="docutils literal notranslate"><span class="pre">read_weight_matrix()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nes.methods.spatial_join">Spatial join</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.spatial_join.get_bbox"><code class="docutils literal notranslate"><span class="pre">get_bbox()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.spatial_join.prepare_external_shapefile"><code class="docutils literal notranslate"><span class="pre">prepare_external_shapefile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.spatial_join.spatial_join"><code class="docutils literal notranslate"><span class="pre">spatial_join()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.spatial_join.spatial_join_centroid"><code class="docutils literal notranslate"><span class="pre">spatial_join_centroid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.spatial_join.spatial_join_intersection"><code class="docutils literal notranslate"><span class="pre">spatial_join_intersection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.spatial_join.spatial_join_nearest"><code class="docutils literal notranslate"><span class="pre">spatial_join_nearest()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-nes.methods.vertical_interpolation">Vertical interpolation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.vertical_interpolation.add_4d_vertical_info"><code class="docutils literal notranslate"><span class="pre">add_4d_vertical_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#nes.methods.vertical_interpolation.interpolate_vertical"><code class="docutils literal notranslate"><span class="pre">interpolate_vertical()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="formats.html">Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="projections.html">Projections</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">CHANGELOG</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NES</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Methods</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/methods.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="methods">
<h1>Methods<a class="headerlink" href="#methods" title="Link to this heading"></a></h1>
<section id="module-nes.methods.cell_measures">
<span id="generic-methods"></span><h2>Generic methods<a class="headerlink" href="#module-nes.methods.cell_measures" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.cell_measures.calculate_cell_area">
<span class="sig-prename descclassname"><span class="pre">nes.methods.cell_measures.</span></span><span class="sig-name descname"><span class="pre">calculate_cell_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_corner_lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_corner_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">earth_radius_minor_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6356752.3142</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">earth_radius_major_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6378137.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/cell_measures.html#calculate_cell_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.cell_measures.calculate_cell_area" title="Link to this definition"></a></dt>
<dd><p>Calculate the area of each cell of a grid.</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>grid_corner_lon<span class="classifier">np.array</span></dt><dd><p>Array with longitude bounds of grid.</p>
</dd>
<dt>grid_corner_lat<span class="classifier">np.array</span></dt><dd><p>Array with longitude bounds of grid.</p>
</dd>
<dt>earth_radius_minor_axis<span class="classifier">float</span></dt><dd><p>Radius of the minor axis of the Earth.</p>
</dd>
<dt>earth_radius_major_axis<span class="classifier">float</span></dt><dd><p>Radius of the major axis of the Earth.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.cell_measures.calculate_geometry_area">
<span class="sig-prename descclassname"><span class="pre">nes.methods.cell_measures.</span></span><span class="sig-name descname"><span class="pre">calculate_geometry_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">earth_radius_minor_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6356752.3142</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">earth_radius_major_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6378137.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/cell_measures.html#calculate_geometry_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.cell_measures.calculate_geometry_area" title="Link to this definition"></a></dt>
<dd><p>Get coordinate bounds and call function to calculate the area of each cell of a set of geometries.</p>
<section id="id1">
<h3>Parameters<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>geometry_list<span class="classifier">List</span></dt><dd><p>List with polygon geometries.</p>
</dd>
<dt>earth_radius_minor_axis<span class="classifier">float</span></dt><dd><p>Radius of the minor axis of the Earth.</p>
</dd>
<dt>earth_radius_major_axis<span class="classifier">float</span></dt><dd><p>Radius of the major axis of the Earth.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.cell_measures.calculate_grid_area">
<span class="sig-prename descclassname"><span class="pre">nes.methods.cell_measures.</span></span><span class="sig-name descname"><span class="pre">calculate_grid_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/cell_measures.html#calculate_grid_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.cell_measures.calculate_grid_area" title="Link to this definition"></a></dt>
<dd><p>Get coordinate bounds and call function to calculate the area of each cell of a grid.</p>
<section id="id2">
<h3>Parameters<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>self<span class="classifier">nes.Nes</span></dt><dd><p>Source projection Nes Object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.cell_measures.cross_product">
<span class="sig-prename descclassname"><span class="pre">nes.methods.cell_measures.</span></span><span class="sig-name descname"><span class="pre">cross_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/cell_measures.html#cross_product"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.cell_measures.cross_product" title="Link to this definition"></a></dt>
<dd><p>Calculate cross product between two points.</p>
<section id="id3">
<h3>Parameters<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>a<span class="classifier">np.array</span></dt><dd><p>Position of point a in cartesian coordinates.</p>
</dd>
<dt>b<span class="classifier">np.array</span></dt><dd><p>Position of point b in cartesian coordinates.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.cell_measures.lon_lat_to_cartesian">
<span class="sig-prename descclassname"><span class="pre">nes.methods.cell_measures.</span></span><span class="sig-name descname"><span class="pre">lon_lat_to_cartesian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">earth_radius_major_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6378137.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/cell_measures.html#lon_lat_to_cartesian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.cell_measures.lon_lat_to_cartesian" title="Link to this definition"></a></dt>
<dd><p>Calculate lon, lat coordinates of a point on a sphere.</p>
<section id="id4">
<h3>Parameters<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>lon<span class="classifier">np.array</span></dt><dd><p>Longitude values.</p>
</dd>
<dt>lat<span class="classifier">np.array</span></dt><dd><p>Latitude values.</p>
</dd>
<dt>earth_radius_major_axis<span class="classifier">float</span></dt><dd><p>Radius of the major axis of the Earth.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.cell_measures.mod_huiliers_area">
<span class="sig-prename descclassname"><span class="pre">nes.methods.cell_measures.</span></span><span class="sig-name descname"><span class="pre">mod_huiliers_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_corner_lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_corner_lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/cell_measures.html#mod_huiliers_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.cell_measures.mod_huiliers_area" title="Link to this definition"></a></dt>
<dd><p>Calculate the area of each cell according to Huilier’s theorem.
Reference: CDO (<a class="reference external" href="https://earth.bsc.es/gitlab/ces/cdo/">https://earth.bsc.es/gitlab/ces/cdo/</a>).</p>
<section id="id5">
<h3>Parameters<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>cell_corner_lon<span class="classifier">np.array</span></dt><dd><p>Longitude boundaries of each cell.</p>
</dd>
<dt>cell_corner_lat<span class="classifier">np.array</span></dt><dd><p>Latitude boundaries of each cell.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.cell_measures.norm">
<span class="sig-prename descclassname"><span class="pre">nes.methods.cell_measures.</span></span><span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/cell_measures.html#norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.cell_measures.norm" title="Link to this definition"></a></dt>
<dd><p>Normalize the result of the cross product operation.</p>
<section id="id6">
<h3>Parameters<a class="headerlink" href="#id6" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>cp<span class="classifier">np.array</span></dt><dd><p>Cross product between two points.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.cell_measures.tri_area">
<span class="sig-prename descclassname"><span class="pre">nes.methods.cell_measures.</span></span><span class="sig-name descname"><span class="pre">tri_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/cell_measures.html#tri_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.cell_measures.tri_area" title="Link to this definition"></a></dt>
<dd><p>Calculate area between three points that form a triangle.
Reference: CDO (<a class="reference external" href="https://earth.bsc.es/gitlab/ces/cdo/">https://earth.bsc.es/gitlab/ces/cdo/</a>).</p>
<section id="id7">
<h3>Parameters<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>point_0<span class="classifier">np.array</span></dt><dd><p>Position of first point in cartesian coordinates.</p>
</dd>
<dt>point_1<span class="classifier">np.array</span></dt><dd><p>Position of second point in cartesian coordinates.</p>
</dd>
<dt>point_2<span class="classifier">np.array</span></dt><dd><p>Position of third point in cartesian coordinates.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-nes.methods.horizontal_interpolation">
<span id="horizontal-interpolation"></span><h2>Horizontal interpolation<a class="headerlink" href="#module-nes.methods.horizontal_interpolation" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.horizontal_interpolation.create_area_conservative_weight_matrix">
<span class="sig-prename descclassname"><span class="pre">nes.methods.horizontal_interpolation.</span></span><span class="sig-name descname"><span class="pre">create_area_conservative_weight_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_nes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wm_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/horizontal_interpolation.html#create_area_conservative_weight_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.horizontal_interpolation.create_area_conservative_weight_matrix" title="Link to this definition"></a></dt>
<dd><p>To create the weight matrix with the area conservative method.</p>
<section id="id8">
<h3>Parameters<a class="headerlink" href="#id8" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>self<span class="classifier">nes.Nes</span></dt><dd><p>Source projection Nes Object.</p>
</dd>
<dt>dst_nes<span class="classifier">nes.Nes</span></dt><dd><p>Final projection Nes object.</p>
</dd>
<dt>wm_path<span class="classifier">str</span></dt><dd><p>Path where write the weight matrix.</p>
</dd>
<dt>flux<span class="classifier">bool</span></dt><dd><p>Indicates if you want to calculate the weight matrix for flux variables.</p>
</dd>
<dt>info: bool</dt><dd><p>Indicates if you want to print extra info during the methods process.</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>nes.Nes</dt><dd><p>Weight matrix.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.horizontal_interpolation.create_nn_weight_matrix">
<span class="sig-prename descclassname"><span class="pre">nes.methods.horizontal_interpolation.</span></span><span class="sig-name descname"><span class="pre">create_nn_weight_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wm_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/horizontal_interpolation.html#create_nn_weight_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.horizontal_interpolation.create_nn_weight_matrix" title="Link to this definition"></a></dt>
<dd><p>To create the weight matrix with the nearest neighbours method.</p>
<section id="id9">
<h3>Parameters<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>self<span class="classifier">nes.Nes</span></dt><dd><p>Source projection Nes Object.</p>
</dd>
<dt>dst_grid<span class="classifier">nes.Nes</span></dt><dd><p>Final projection Nes object.</p>
</dd>
<dt>n_neighbours<span class="classifier">int</span></dt><dd><p>Used if kind == NearestNeighbour. Number of nearest neighbours to interpolate. Default: 4.</p>
</dd>
<dt>wm_path<span class="classifier">str</span></dt><dd><p>Path where write the weight matrix.</p>
</dd>
<dt>info: bool</dt><dd><p>Indicates if you want to print extra info during the methods process.</p>
</dd>
</dl>
</section>
<section id="id10">
<h3>Returns<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>nes.Nes</dt><dd><p>Weight matrix.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.horizontal_interpolation.get_src_data">
<span class="sig-prename descclassname"><span class="pre">nes.methods.horizontal_interpolation.</span></span><span class="sig-name descname"><span class="pre">get_src_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel_method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/horizontal_interpolation.html#get_src_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.horizontal_interpolation.get_src_data" title="Link to this definition"></a></dt>
<dd><p>To obtain the needed src data to interpolate.</p>
<section id="id11">
<h3>Parameters<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>comm<span class="classifier">MPI.Communicator.</span></dt><dd><p>MPI communicator.</p>
</dd>
<dt>var_data<span class="classifier">np.array</span></dt><dd><p>Rank source data.</p>
</dd>
<dt>idx<span class="classifier">np.array</span></dt><dd><p>Index of the needed data in a 2D flatten way.</p>
</dd>
<dt>parallel_method: str</dt><dd><p>Source parallel method.</p>
</dd>
</dl>
</section>
<section id="id12">
<h3>Returns<a class="headerlink" href="#id12" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>np.array</dt><dd><p>Flatten source needed data.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.horizontal_interpolation.get_weights_idx_t_axis">
<span class="sig-prename descclassname"><span class="pre">nes.methods.horizontal_interpolation.</span></span><span class="sig-name descname"><span class="pre">get_weights_idx_t_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_matrix_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbours</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_create</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/horizontal_interpolation.html#get_weights_idx_t_axis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.horizontal_interpolation.get_weights_idx_t_axis" title="Link to this definition"></a></dt>
<dd><p>To obtain the weights and source data index through the T axis.</p>
<section id="id13">
<h3>Parameters<a class="headerlink" href="#id13" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>self<span class="classifier">nes.Nes</span></dt><dd><p>Source projection Nes Object.</p>
</dd>
<dt>dst_grid<span class="classifier">nes.Nes</span></dt><dd><p>Final projection Nes object.</p>
</dd>
<dt>weight_matrix_path<span class="classifier">str, None</span></dt><dd><p>Path to the weight matrix to read/create.</p>
</dd>
<dt>kind<span class="classifier">str</span></dt><dd><p>Kind of horizontal interpolation. Accepted values: [‘NearestNeighbour’, ‘Conservative’].</p>
</dd>
<dt>n_neighbours<span class="classifier">int</span></dt><dd><p>Used if kind == NearestNeighbour. Number of nearest neighbours to interpolate. Default: 4.</p>
</dd>
<dt>only_create<span class="classifier">bool</span></dt><dd><p>Indicates if you want to only create the Weight Matrix.</p>
</dd>
<dt>wm<span class="classifier">Nes</span></dt><dd><p>Weight matrix Nes File.</p>
</dd>
<dt>flux<span class="classifier">bool</span></dt><dd><p>Indicates if you want to calculate the weight matrix for flux variables.</p>
</dd>
</dl>
</section>
<section id="id14">
<h3>Returns<a class="headerlink" href="#id14" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>tuple</dt><dd><p>Weights and source data index.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.horizontal_interpolation.get_weights_idx_xy_axis">
<span class="sig-prename descclassname"><span class="pre">nes.methods.horizontal_interpolation.</span></span><span class="sig-name descname"><span class="pre">get_weights_idx_xy_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_matrix_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbours</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_create</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/horizontal_interpolation.html#get_weights_idx_xy_axis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.horizontal_interpolation.get_weights_idx_xy_axis" title="Link to this definition"></a></dt>
<dd><p>To obtain the weights and source data index through the X or Y axis.</p>
<section id="id15">
<h3>Parameters<a class="headerlink" href="#id15" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>self<span class="classifier">nes.Nes</span></dt><dd><p>Source projection Nes Object.</p>
</dd>
<dt>dst_grid<span class="classifier">nes.Nes</span></dt><dd><p>Final projection Nes object.</p>
</dd>
<dt>weight_matrix_path<span class="classifier">str, None</span></dt><dd><p>Path to the weight matrix to read/create.</p>
</dd>
<dt>kind<span class="classifier">str</span></dt><dd><p>Kind of horizontal interpolation. Accepted values: [‘NearestNeighbour’, ‘Conservative’].</p>
</dd>
<dt>n_neighbours<span class="classifier">int</span></dt><dd><p>Used if kind == NearestNeighbour. Number of nearest neighbours to interpolate. Default: 4.</p>
</dd>
<dt>only_create<span class="classifier">bool</span></dt><dd><p>Indicates if you want to only create the Weight Matrix.</p>
</dd>
<dt>wm<span class="classifier">Nes</span></dt><dd><p>Weight matrix Nes File.</p>
</dd>
<dt>flux<span class="classifier">bool</span></dt><dd><p>Indicates if you want to calculate the weight matrix for flux variables.</p>
</dd>
</dl>
</section>
<section id="id16">
<h3>Returns<a class="headerlink" href="#id16" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>tuple</dt><dd><p>Weights and source data index.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.horizontal_interpolation.interpolate_horizontal">
<span class="sig-prename descclassname"><span class="pre">nes.methods.horizontal_interpolation.</span></span><span class="sig-name descname"><span class="pre">interpolate_horizontal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_matrix_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NearestNeighbour'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_providentia</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_create_wm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/horizontal_interpolation.html#interpolate_horizontal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.horizontal_interpolation.interpolate_horizontal" title="Link to this definition"></a></dt>
<dd><p>Horizontal methods from one grid to another one.</p>
<section id="id17">
<h3>Parameters<a class="headerlink" href="#id17" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>self<span class="classifier">nes.Nes</span></dt><dd><p>Source projection Nes Object.</p>
</dd>
<dt>dst_grid<span class="classifier">nes.Nes</span></dt><dd><p>Final projection Nes object.</p>
</dd>
<dt>weight_matrix_path<span class="classifier">str, None</span></dt><dd><p>Path to the weight matrix to read/create.</p>
</dd>
<dt>kind<span class="classifier">str</span></dt><dd><p>Kind of horizontal interpolation. Accepted values: [‘NearestNeighbour’, ‘Conservative’].</p>
</dd>
<dt>n_neighbours<span class="classifier">int</span></dt><dd><p>Used if kind == NearestNeighbour. Number of nearest neighbours to interpolate. Default: 4.</p>
</dd>
<dt>info<span class="classifier">bool</span></dt><dd><p>Indicates if you want to print extra info during the methods process.</p>
</dd>
<dt>to_providentia<span class="classifier">bool</span></dt><dd><p>Indicates if we want the interpolated grid in Providentia format.</p>
</dd>
<dt>only_create_wm<span class="classifier">bool</span></dt><dd><p>Indicates if you want to only create the Weight Matrix.</p>
</dd>
<dt>wm<span class="classifier">Nes</span></dt><dd><p>Weight matrix Nes File.</p>
</dd>
<dt>flux<span class="classifier">bool</span></dt><dd><p>Indicates if you want to calculate the weight matrix for flux variables.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.horizontal_interpolation.lon_lat_to_cartesian">
<span class="sig-prename descclassname"><span class="pre">nes.methods.horizontal_interpolation.</span></span><span class="sig-name descname"><span class="pre">lon_lat_to_cartesian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6378137.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/horizontal_interpolation.html#lon_lat_to_cartesian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.horizontal_interpolation.lon_lat_to_cartesian" title="Link to this definition"></a></dt>
<dd><p>Calculate lon, lat coordinates of a point on a sphere.</p>
<p>DEPRECATED!!!!</p>
<section id="id18">
<h3>Parameters<a class="headerlink" href="#id18" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>lon<span class="classifier">np.array</span></dt><dd><p>Longitude values.</p>
</dd>
<dt>lat<span class="classifier">np.array</span></dt><dd><p>Latitude values.</p>
</dd>
<dt>radius<span class="classifier">float</span></dt><dd><p>Radius of the sphere to get the distances.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.horizontal_interpolation.lon_lat_to_cartesian_ecef">
<span class="sig-prename descclassname"><span class="pre">nes.methods.horizontal_interpolation.</span></span><span class="sig-name descname"><span class="pre">lon_lat_to_cartesian_ecef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/horizontal_interpolation.html#lon_lat_to_cartesian_ecef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.horizontal_interpolation.lon_lat_to_cartesian_ecef" title="Link to this definition"></a></dt>
<dd><p>Convert observational/model geographic longitude/latitude coordinates to cartesian ECEF (Earth Centred,
Earth Fixed) coordinates, assuming WGS84 datum and ellipsoid, and that all heights = 0.
ECEF coordiantes represent positions (in meters) as X, Y, Z coordinates, approximating the earth surface
as an ellipsoid of revolution.
This conversion is for the subsequent calculation of euclidean distances of the model gridcell centres
from each observational station.
Defining the distance between two points on the earth’s surface as simply the euclidean distance
between the two lat/lon pairs could lead to inaccurate results depending on the distance
between two points (i.e. 1 deg. of longitude varies with latitude).</p>
<section id="id19">
<h3>Parameters<a class="headerlink" href="#id19" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>lon<span class="classifier">np.array</span></dt><dd><p>Longitude values.</p>
</dd>
<dt>lat<span class="classifier">np.array</span></dt><dd><p>Latitude values.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.horizontal_interpolation.read_weight_matrix">
<span class="sig-prename descclassname"><span class="pre">nes.methods.horizontal_interpolation.</span></span><span class="sig-name descname"><span class="pre">read_weight_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_matrix_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'T'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/horizontal_interpolation.html#read_weight_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.horizontal_interpolation.read_weight_matrix" title="Link to this definition"></a></dt>
<dd><p>Read weight matrix.</p>
<section id="id20">
<h3>Parameters<a class="headerlink" href="#id20" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>weight_matrix_path<span class="classifier">str</span></dt><dd><p>Path of the weight matrix.</p>
</dd>
<dt>comm<span class="classifier">MPI.Communicator</span></dt><dd><p>Communicator to read the weight matrix.</p>
</dd>
<dt>parallel_method<span class="classifier">str</span></dt><dd><p>Nes parallel method to read the weight matrix.</p>
</dd>
</dl>
</section>
<section id="id21">
<h3>Returns<a class="headerlink" href="#id21" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>nes.Nes</dt><dd><p>Weight matrix.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-nes.methods.spatial_join">
<span id="spatial-join"></span><h2>Spatial join<a class="headerlink" href="#module-nes.methods.spatial_join" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.spatial_join.get_bbox">
<span class="sig-prename descclassname"><span class="pre">nes.methods.spatial_join.</span></span><span class="sig-name descname"><span class="pre">get_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/spatial_join.html#get_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.spatial_join.get_bbox" title="Link to this definition"></a></dt>
<dd><p>Obtain the bounding box of the rank data (lon_min, lat_min, lon_max, lat_max).</p>
<section id="id22">
<h3>Parameters<a class="headerlink" href="#id22" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>self<span class="classifier">nes.Nes</span></dt><dd><p>Nes Object.</p>
</dd>
</dl>
</section>
<section id="id23">
<h3>Returns<a class="headerlink" href="#id23" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>tuple</dt><dd><p>Bounding box</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.spatial_join.prepare_external_shapefile">
<span class="sig-prename descclassname"><span class="pre">nes.methods.spatial_join.</span></span><span class="sig-name descname"><span class="pre">prepare_external_shapefile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_shp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_bbox</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/spatial_join.html#prepare_external_shapefile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.spatial_join.prepare_external_shapefile" title="Link to this definition"></a></dt>
<dd><p>Prepare the external shapefile.</p>
<p>It is high recommended to pass ext_shp parameter as string because it will clip the external shapefile to the rank.</p>
<ol class="arabic simple">
<li><p>Read if it is not already read</p></li>
<li><p>Filter variables list</p></li>
<li><p>Standardize projections</p></li>
</ol>
<section id="id24">
<h3>Parameters<a class="headerlink" href="#id24" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>self<span class="classifier">nes.Nes</span></dt><dd><p>Nes Object.</p>
</dd>
<dt>ext_shp<span class="classifier">GeoDataFrame or str</span></dt><dd><p>External shapefile or path to it.</p>
</dd>
<dt>var_list<span class="classifier">List[str] or None</span></dt><dd><p>External shapefile variables to be computed.</p>
</dd>
<dt>info<span class="classifier">bool</span></dt><dd><p>Indicates if you want to print the information.</p>
</dd>
<dt>apply_bbox<span class="classifier">bool</span></dt><dd><p>Indicates if you want to reduce the shapefile to a bbox.</p>
</dd>
</dl>
</section>
<section id="id25">
<h3>Returns<a class="headerlink" href="#id25" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>GeoDataFrame</dt><dd><p>External shapefile.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.spatial_join.spatial_join">
<span class="sig-prename descclassname"><span class="pre">nes.methods.spatial_join.</span></span><span class="sig-name descname"><span class="pre">spatial_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_shp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_bbox</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/spatial_join.html#spatial_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.spatial_join.spatial_join" title="Link to this definition"></a></dt>
<dd><p>Compute overlay intersection of two GeoPandasDataFrames.</p>
<section id="id26">
<h3>Parameters<a class="headerlink" href="#id26" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>self<span class="classifier">nes.Nes</span></dt><dd><p>Nes Object.</p>
</dd>
<dt>ext_shp<span class="classifier">GeoPandasDataFrame or str</span></dt><dd><p>File or path from where the data will be obtained on the intersection.</p>
</dd>
<dt>method<span class="classifier">str</span></dt><dd><p>Overlay method. Accepted values: [‘nearest’, ‘intersection’, ‘centroid’].</p>
</dd>
<dt>var_list<span class="classifier">List or None or str</span></dt><dd><p>Variables that will be included in the resulting shapefile.</p>
</dd>
<dt>info<span class="classifier">bool</span></dt><dd><p>Indicates if you want to print the process info.</p>
</dd>
<dt>apply_bbox<span class="classifier">bool</span></dt><dd><p>Indicates if you want to reduce the shapefile to a bbox.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.spatial_join.spatial_join_centroid">
<span class="sig-prename descclassname"><span class="pre">nes.methods.spatial_join.</span></span><span class="sig-name descname"><span class="pre">spatial_join_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_shp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/spatial_join.html#spatial_join_centroid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.spatial_join.spatial_join_centroid" title="Link to this definition"></a></dt>
<dd><p>Perform the spatial join using the centroid method.</p>
<section id="id27">
<h3>Parameters<a class="headerlink" href="#id27" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>self<span class="classifier">nes.Nes</span></dt><dd><p>Nes Object.</p>
</dd>
<dt>ext_shp<span class="classifier">GeoDataFrame</span></dt><dd><p>External shapefile.</p>
</dd>
<dt>info<span class="classifier">bool</span></dt><dd><p>Indicates if you want to print the information.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.spatial_join.spatial_join_intersection">
<span class="sig-prename descclassname"><span class="pre">nes.methods.spatial_join.</span></span><span class="sig-name descname"><span class="pre">spatial_join_intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_shp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/spatial_join.html#spatial_join_intersection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.spatial_join.spatial_join_intersection" title="Link to this definition"></a></dt>
<dd><p>Perform the spatial join using the intersection method.</p>
<section id="id28">
<h3>Parameters<a class="headerlink" href="#id28" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>self<span class="classifier">nes.Nes</span></dt><dd><p>Nes Object.</p>
</dd>
<dt>ext_shp<span class="classifier">GeoDataFrame</span></dt><dd><p>External shapefile.</p>
</dd>
<dt>info<span class="classifier">bool</span></dt><dd><p>Indicates if you want to print the information.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.spatial_join.spatial_join_nearest">
<span class="sig-prename descclassname"><span class="pre">nes.methods.spatial_join.</span></span><span class="sig-name descname"><span class="pre">spatial_join_nearest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_shp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/spatial_join.html#spatial_join_nearest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.spatial_join.spatial_join_nearest" title="Link to this definition"></a></dt>
<dd><p>Perform the spatial join using the nearest method.</p>
<section id="id29">
<h3>Parameters<a class="headerlink" href="#id29" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>self<span class="classifier">nes.Nes</span></dt><dd><p>Nes Object.</p>
</dd>
<dt>ext_shp<span class="classifier">GeoDataFrame</span></dt><dd><p>External shapefile.</p>
</dd>
<dt>info<span class="classifier">bool</span></dt><dd><p>Indicates if you want to print the information.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-nes.methods.vertical_interpolation">
<span id="vertical-interpolation"></span><h2>Vertical interpolation<a class="headerlink" href="#module-nes.methods.vertical_interpolation" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.vertical_interpolation.add_4d_vertical_info">
<span class="sig-prename descclassname"><span class="pre">nes.methods.vertical_interpolation.</span></span><span class="sig-name descname"><span class="pre">add_4d_vertical_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info_to_add</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/vertical_interpolation.html#add_4d_vertical_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.vertical_interpolation.add_4d_vertical_info" title="Link to this definition"></a></dt>
<dd><p>To add the vertical information from other source.</p>
<section id="id30">
<h3>Parameters<a class="headerlink" href="#id30" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>self<span class="classifier">nes.Nes</span></dt><dd><p>Source Nes object.</p>
</dd>
<dt>info_to_add<span class="classifier">nes.Nes, str</span></dt><dd><p>Nes object with the vertical information as variable or str with the path to the NetCDF file that contains
the vertical data.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nes.methods.vertical_interpolation.interpolate_vertical">
<span class="sig-prename descclassname"><span class="pre">nes.methods.vertical_interpolation.</span></span><span class="sig-name descname"><span class="pre">interpolate_vertical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_src_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nes/methods/vertical_interpolation.html#interpolate_vertical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nes.methods.vertical_interpolation.interpolate_vertical" title="Link to this definition"></a></dt>
<dd><p>Vertical interpolation.</p>
<section id="id31">
<h3>Parameters<a class="headerlink" href="#id31" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>self<span class="classifier">Nes</span></dt><dd><p>Source Nes object.</p>
</dd>
<dt>new_levels<span class="classifier">List</span></dt><dd><p>List of new vertical levels.</p>
</dd>
<dt>new_src_vertical<span class="classifier">nes.Nes, str</span></dt><dd><p>Nes object with the vertical information as variable or str with the path to the NetCDF file that contains
the vertical data.</p>
</dd>
<dt>kind<span class="classifier">str</span></dt><dd><p>Vertical methods type.</p>
</dd>
<dt>extrapolate<span class="classifier">None, tuple, str</span></dt><dd><p>Extrapolate method (for non linear operations).</p>
</dd>
<dt>info: None, bool</dt><dd><p>Indicates if you want to print extra information.</p>
</dd>
<dt>overwrite: bool</dt><dd><p>Indicates if you want to compute the vertical interpolation in the same object or not.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="object.html" class="btn btn-neutral float-left" title="The NES object" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="formats.html" class="btn btn-neutral float-right" title="Formats" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Carles Tena Medina, Alba Vilanova Cortezon.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>