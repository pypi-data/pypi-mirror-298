from api.utils.pykafka_client import PykafkaClient

pykafka_client = PykafkaClient(hosts="10.194.6.80:9092,10.194.9.44:9092")
topic_list = [
    "AIS20201114183546.dbo.T_SAL_ORDER",
    "AIS20201114183546.dbo.T_SAL_ORDERENTRY",
    "AIS20201114183546.dbo.T_SAL_ORDERENTRY_F",
    "AIS20201114183546.dbo.T_SAL_OUTSTOCK",
    "AIS20201114183546.dbo.T_SAL_OUTSTOCKENTRY",
    "AIS20201114183546.dbo.T_SAL_OUTSTOCKENTRY_F",
    "AIS20201114183546.dbo.T_SAL_RETURNSTOCK",
    "AIS20201114183546.dbo.T_SAL_RETURNSTOCKENTRY",
    "AIS20201114183546.dbo.T_SAL_RETURNSTOCKENTRY_F",
    "AIS20201114183546.dbo.T_STK_INVENTORY",
    "AIS20201114183546.dbo.T_STK_INSTOCK",
    "AIS20201114183546.dbo.T_STK_INSTOCKENTRY",
    "AIS20201114183546.dbo.T_STK_INSTOCKENTRY_F",
    "AIS20201114183546.dbo.T_PUR_MRB",
    "AIS20201114183546.dbo.T_PUR_MRBENTRY",
    "AIS20201114183546.dbo.T_PUR_MRBENTRY_F",
    "AIS20201114183546.dbo.T_PUR_REQUISITION",
    "AIS20201114183546.dbo.T_PUR_REQENTRY",
    "AIS20201114183546.dbo.T_PUR_REQENTRY_R",
    "AIS20201114183546.dbo.T_PUR_REQENTRY_S",
]


for topic in topic_list:
    partition_offset = pykafka_client.get_partition_offsets(topic)
    print(f"Topic: {topic}, Partition Offset: {partition_offset}")
